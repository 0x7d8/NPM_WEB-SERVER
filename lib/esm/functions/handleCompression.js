import{PassThrough as a}from"stream";import*as s from"zlib";var n={none:"none",gzip:"gzip",brotli:"br",deflate:"deflate"},t=class extends a{};function p(e){switch(e){case"gzip":return s.createGzip();case"brotli":return s.createBrotliCompress();case"deflate":return s.createDeflate();default:return new t}}function m(e,r,o){if(!r.compressed&&!e.rawRes.headersSent&&String(e.headers.get("accept-encoding")).includes(n[o.compression])){e.rawRes.setHeader("Content-Encoding",n[o.compression]),e.rawRes.setHeader("Vary","Accept-Encoding");let i=p(o.compression);i.pipe(e.rawRes),i.end(r.content,"binary")}else e.rawRes.end(r.content,"binary")}export{m as default};
