var A=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,s)=>(typeof require<"u"?require:e)[s]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});import*as p from"fs";var u=(r,e)=>(e=e||[],p.readdirSync(r).forEach(t=>{if(p.statSync(`${r}/${t}`).isDirectory())e=u(`${r}/${t}`,e);else{let o=`${r}/${t}`;e.push(o)}}),e),$=(r,e,s)=>(s=s||[],s=u(r,s).filter(t=>t.endsWith(e)),s);var l=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"];import*as L from"path";import*as S from"fs";var c=r=>(r=r.replace(/\/{2,}/g,"/"),r.endsWith("/")&&r!=="/"?r.slice(0,-1):!r.startsWith("/")&&r!=="/"?`/${r}`:r.includes("/?")?r.replace("/?","?"):r),d=class{constructor(e,s){e=e!=null?e:[],s=s!=null?s:[],this.routes=e,this.events=s}event(e,s){return this.events.some(t=>t.event===e)?!1:this.events.push({event:e,code:s})-1}set(e,s,t){if(s=c(s),!l.includes(e))throw TypeError(`No Valid Request Type: ${e}
Possible Values: ${l.join(", ")}`);return this.routes.some(o=>o.method===e&&o.path===s)?!1:this.routes.push({method:e,path:s,pathArray:s.split("/"),code:t,data:{addTypes:!1}})-1}static(e,s,t){var b,g,y;e=c(e);let o=(b=t==null?void 0:t.preload)!=null?b:!1,n=(g=t==null?void 0:t.remHTML)!=null?g:!1,i=(y=t==null?void 0:t.addTypes)!=null?y:!0,a=[];for(let m of u(s)){let f=m.replace(s,"");n&&(f=f.replace("/index.html","/").replace(".html",""));let T=c(f),x=this.routes.push({method:"STATIC",path:T,pathArray:T.split("/"),code:async()=>{},data:{addTypes:i,file:m}});o&&(this.routes[x-1].data.content=S.readFileSync(m)),a.push(x-1)}return a}load(e){let s=$(e,".js"),t=[];for(let o of s){let n=A(L.resolve(o));if(!(!("path"in n)||!("method"in n)||!("code"in n))){if(!l.includes(n.method))throw TypeError(`No Valid Request Type: ${n.method}
Possible Values: ${l.join(", ")}`);t.push(this.routes.push({method:n.method,path:c(n.path),pathArray:c(n.path).split("/"),code:n.code,data:{addTypes:!1}})-1)}}return t}list(){return{routes:this.routes,events:this.events}}};var h=class{constructor(e){this.data=this.mergeOptions({routes:new d,rateLimits:{enabled:!1,message:"Rate Limited",list:[],functions:new Map},body:{enabled:!0,parse:!0,maxSize:5,message:"Payload too large"},https:{enabled:!1,keyFile:"/ssl/key/path",certFile:"/ssl/cert/path"},dashboard:{enabled:!1,path:"/rjweb-dashboard"},bind:"0.0.0.0",proxy:!1,compress:!1,cors:!1,port:2023,poweredBy:!0},e)}mergeOptions(...e){let s=t=>t&&typeof t=="object";return e.reduce((t,o)=>(Object.keys(o).forEach(n=>{let i=t[n],a=o[n];n!=="functions"&&n!=="routes"?Array.isArray(i)&&Array.isArray(a)?t[n]=i.concat(...a):s(i)&&s(a)?t[n]=this.mergeOptions(i,a):t[n]=a:t[n]=a}),t),{})}getOptions(){return this.data}};export{h as default};
