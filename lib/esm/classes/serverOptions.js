var A=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});import*as c from"fs";var u=(n,e)=>(e=e||[],c.readdirSync(n).forEach(t=>{if(c.statSync(`${n}/${t}`).isDirectory())e=u(`${n}/${t}`,e);else{let o=`${n}/${t}`;e.push(o)}}),e),$=(n,e,r)=>(r=r||[],r=u(n,r).filter(t=>t.endsWith(e)),r);var d=["OPTIONS","DELETE","PATCH","STATIC","HEAD","POST","PUT","GET"];import*as I from"path";import*as R from"fs";var i=(n,e)=>(n=n.replace(/\/{2,}/g,"/"),n.endsWith("/")&&n!=="/"?n.slice(0,-1):!n.startsWith("/")&&n!=="/"?`/${n}`:n.includes("/?")?n.replace("/?","?"):e&&n==="/"?"":n),p=class{constructor(e,r){e=e!=null?e:[],r=r!=null?r:[],this.routes=e,this.events=r}event(e,r){return this.events.some(t=>t.event===e)?!1:this.events.push({event:e,code:r})-1}set(e,r,t){if(r=i(r),!d.includes(e))throw TypeError(`No Valid Request Type: ${e}, Possible Values: ${d.join(", ")}`);return this.routes.some(o=>o.method===e&&o.path===r)?!1:this.routes.push({method:e,path:r,pathArray:r.split("/"),code:t,data:{addTypes:!1}})-1}setBlock(e,r){e=i(e);let t=[];for(let o=0;o<=r.length-1;o++){let s=r[o];t.push(this.routes.push({method:s.method,path:`${e}${i(s.path,!0)}`,pathArray:`${e}${i(s.path,!0)}`.split("/"),code:s.code,data:{addTypes:!1}})-1)}return t}setRedirects(e){let r=[];for(let t=0;t<=e.length-1;t++){let o=e[t];r.push(this.routes.push({method:o.method,path:i(o.path),pathArray:i(o.path,!0).split("/"),code:async s=>s.redirect(o.destination),data:{addTypes:!1}})-1)}return r}static(e,r,t){var y,b,g;e=i(e);let o=(y=t==null?void 0:t.preload)!=null?y:!1,s=(b=t==null?void 0:t.remHTML)!=null?b:!1,l=(g=t==null?void 0:t.addTypes)!=null?g:!0,a=[];for(let m of u(r)){let h=m.replace(r,"");s&&(h=h.replace("/index.html","/").replace(".html",""));let T=i(h),x=this.routes.push({method:"STATIC",path:T,pathArray:T.split("/"),code:async()=>{},data:{addTypes:l,file:m}});o&&(this.routes[x-1].data.content=R.readFileSync(m)),a.push(x-1)}return a}load(e){let r=$(e,".js"),t=[];for(let o of r){let s=A(I.resolve(o));if(!(!("path"in s)||!("method"in s)||!("code"in s))){if(!d.includes(s.method))throw TypeError(`No Valid Request Type: ${s.method}, Possible Values: ${d.join(", ")}`);t.push(this.routes.push({method:s.method,path:i(s.path),pathArray:i(s.path).split("/"),code:s.code,data:{addTypes:!1}})-1)}}return t}list(){return{routes:this.routes,events:this.events}}};var f=class{constructor(e){this.data=this.mergeOptions({routes:new p,rateLimits:{enabled:!1,message:"Rate Limited",list:[],functions:new Map},body:{enabled:!0,parse:!0,maxSize:5,message:"Payload too large"},https:{enabled:!1,keyFile:"/ssl/key/path",certFile:"/ssl/cert/path"},dashboard:{enabled:!1,path:"/rjweb-dashboard"},headers:{},bind:"0.0.0.0",proxy:!1,compression:"none",cors:!1,port:2023,poweredBy:!0},e)}mergeOptions(...e){let r=t=>t&&typeof t=="object";return e.reduce((t,o)=>(Object.keys(o).forEach(s=>{let l=t[s],a=o[s];s!=="functions"&&s!=="routes"?Array.isArray(l)&&Array.isArray(a)?t[s]=l.concat(...a):r(l)&&r(a)?t[s]=this.mergeOptions(l,a):t[s]=a:t[s]=a}),t),{})}getOptions(){return this.data}};export{f as default};
