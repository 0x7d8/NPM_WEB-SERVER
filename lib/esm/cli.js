#!/usr/bin/env node
var ye=Object.create;var Y=Object.defineProperty;var be=Object.getOwnPropertyDescriptor;var ve=Object.getOwnPropertyNames;var we=Object.getPrototypeOf,He=Object.prototype.hasOwnProperty;var ee=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(r,o)=>(typeof require<"u"?require:r)[o]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var V=(t,r)=>()=>(t&&(r=t(t=0)),r);var Te=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var xe=(t,r,o,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let d of ve(r))!He.call(t,d)&&d!==o&&Y(t,d,{get:()=>r[d],enumerable:!(a=be(r,d))||a.enumerable});return t};var Re=(t,r,o)=>(o=t!=null?ye(we(t)):{},xe(r||!t||!t.__esModule?Y(o,"default",{value:t,enumerable:!0}):o,t));import*as q from"fs";var J,re,se=V(()=>{J=(t,r)=>(r=r||[],q.readdirSync(t).forEach(a=>{if(q.statSync(`${t}/${a}`).isDirectory())r=J(`${t}/${a}`,r);else{let d=`${t}/${a}`;r.push(d)}}),r),re=(t,r,o)=>(o=o||[],o=J(t,o).filter(a=>a.endsWith(r)),o)});var $,G=V(()=>{$=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});import*as oe from"path";import*as ne from"fs";var x,W,K=V(()=>{se();G();x=t=>(t=t.replace(/\/{2,}/g,"/"),t.endsWith("/")&&t!=="/"?t.slice(0,-1):!t.startsWith("/")&&t!=="/"?`/${t}`:t.includes("/?")?t.replace("/?","?"):t),W=class{constructor(r,o){r=r!=null?r:[],o=o!=null?o:[],this.routes=r,this.events=o}event(r,o){return this.events.some(a=>a.event===r)?!1:this.events.push({event:r,code:o})-1}set(r,o,a){if(o=x(o),!$.includes(r))throw TypeError(`No Valid Request Type: ${r}
Possible Values: ${$.join(", ")}`);return this.routes.some(d=>d.method===r&&d.path===o)?!1:this.routes.push({method:r,path:o,pathArray:o.split("/"),code:a,data:{addTypes:!1}})-1}static(r,o,a){var F,j,R;r=x(r);let d=(F=a==null?void 0:a.preload)!=null?F:!1,n=(j=a==null?void 0:a.remHTML)!=null?j:!1,H=(R=a==null?void 0:a.addTypes)!=null?R:!0,m=[];for(let p of J(o)){let c=p.replace(o,"");n&&(c=c.replace("/index.html","/").replace(".html",""));let e=x(c),h=this.routes.push({method:"STATIC",path:e,pathArray:e.split("/"),code:async()=>{},data:{addTypes:H,file:p}});d&&(this.routes[h-1].data.content=ne.readFileSync(p)),m.push(h-1)}return m}load(r){let o=re(r,".js"),a=[];for(let d of o){let n=ee(oe.resolve(d));if(!(!("path"in n)||!("method"in n)||!("code"in n))){if(!$.includes(n.method))throw TypeError(`No Valid Request Type: ${n.method}
Possible Values: ${$.join(", ")}`);a.push(this.routes.push({method:n.method,path:x(n.path),pathArray:x(n.path).split("/"),code:n.code,data:{addTypes:!1}})-1)}}return a}list(){return{routes:this.routes,events:this.events}}}});var z,ae=V(()=>{K();z=class{constructor(r){this.data=this.mergeOptions({routes:new W,rateLimits:{enabled:!1,message:"Rate Limited",list:[],functions:new Map},body:{enabled:!0,parse:!0,maxSize:5,message:"Payload too large"},https:{enabled:!1,keyFile:"/ssl/key/path",certFile:"/ssl/cert/path"},dashboard:{enabled:!1,path:"/rjweb-dashboard"},bind:"0.0.0.0",proxy:!1,compress:!1,cors:!1,port:2023,poweredBy:!0},r)}mergeOptions(...r){let o=a=>a&&typeof a=="object";return r.reduce((a,d)=>(Object.keys(d).forEach(n=>{let H=a[n],m=d[n];n!=="functions"&&n!=="routes"?Array.isArray(H)&&Array.isArray(m)?a[n]=H.concat(...m):o(H)&&o(m)?a[n]=this.mergeOptions(H,m):a[n]=m:a[n]=m}),a),{})}getOptions(){return this.data}}});var T,ie=V(()=>{T=class{constructor(r,o){this.data={};r=r!=null?r:{},o=o!=null?o:a=>a;for(let a in r)this.data[a]=o(r[a])}has(r){return r in this.data}get(r){return this.data[r]}set(r,o){let a=r in this.data;return this.data[r]=o,a}objectCount(){return Object.keys(this.data).length}toJSON(r){r=r!=null?r:[];let o={};for(let a in this.data)r.includes(a)||(o[a]=this.data[a]);return o}toArray(r){r=r!=null?r:[];let o=[];for(let a in this.data)r.includes(a)||o.push(this.data[a]);return o}forEach(r,o){r=r!=null?r:()=>{},o=o!=null?o:[];let a=0;for(let d in this.data)o.includes(d)||(r(d,this.data[d]),a++);return a}}});var ue,ce,de=V(()=>{ue=(m=>(m.options="OPTIONS",m.delete="DELETE",m.patch="PATCH",m.post="POST",m.put="PUT",m.get="GET",m.static="STATIC",m))(ue||{}),ce=ue});import{EventEmitter as Ce}from"stream";import*as Be from"http";import*as Le from"https";import*as fe from"querystring";import*as N from"zlib";import*as pe from"path";import*as me from"url";import*as E from"fs";import*as le from"os";var he=Te((Oe,ge)=>{K();ae();ie();de();G();ge.exports={routeList:W,serverOptions:z,valueCollection:T,types:ce,async start(t){t=new z(t).getOptions();let{routes:r,events:o}=t.routes.list(),a=le.cpus().length,d=new T,n={requests:{total:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0},pageDisplay:"",data:{incoming:{total:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0},outgoing:{total:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0}}},H=(p,c)=>{if(t.compress&&!p.rawRes.headersSent&&p.headers.has("accept-encoding")&&p.headers.get("accept-encoding").includes("gzip")){p.rawRes.setHeader("Content-Encoding","gzip"),p.rawRes.setHeader("Vary","Accept-Encoding");let e=N.createGzip();e.pipe(p.rawRes),e.end(c.content,"binary")}else p.rawRes.end(c.content,"binary")},m=async(p,c,e)=>{switch(p){case"error":{let h=o.find(b=>b.event==="error");h?Promise.resolve(h.code(c)).catch(b=>{console.log(b),c.status(500),e.content=Buffer.from(`An Error occured in your Error Event (what the hell?)
${b.stack}`)}):(console.log(c.error),c.status(500),e.content=Buffer.from(`An Error occured
${c.error.stack}`))}case"request":{let h=!1,b=o.find(l=>l.event==="request");return b&&await Promise.resolve(b.code(c)).catch(l=>{h=!0,console.log(l),c.status(500),e.content=Buffer.from(`An Error occured in your Request Event
${l.stack}`)}),h}case"notfound":{let h=!1,b=o.find(l=>l.event==="notfound");if(b)await Promise.resolve(b.code(c)).catch(l=>{h=!0,console.log(l),c.status(500),e.content=Buffer.from(`An Error occured in your Notfound Event
${l.stack}`)});else{let l="";if(n.pageDisplay)l=n.pageDisplay;else{for(let P of r){let i=P.method==="STATIC"?"GET":P.method;l+=`[-] [${i}] ${P.path}
`}n.pageDisplay=l}c.status(404),e.content=Buffer.from(`[!] COULDNT FIND [${c.url.method}]: ${c.url.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${l}`)}return h}}},F=()=>Array.from({length:5},(p,c)=>(new Date().getHours()-(4-c)+24)%24),j={};t.https.enabled?j={key:await E.promises.readFile(t.https.keyFile).catch(()=>{throw new Error(`Cant access your HTTPS Key file! (${t.https.keyFile})`)}),cert:await E.promises.readFile(t.https.certFile).catch(()=>{throw new Error(`Cant access your HTTPS Cert file! (${t.https.certFile})`)})}:j={};let R=(t.https.enabled?Le:Be).createServer(j,async(p,c)=>{let e={content:Buffer.from(""),events:new Ce,waiting:!1,continue:!0,execute:{route:null,static:!1,exists:!1,dashboard:!1},body:{raw:Buffer.from(""),parsed:""},url:{...me.parse(x(p.url)),method:p.method},previousHours:F()};e.events.on("noWaiting",()=>e.waiting=!1),c.once("close",()=>e.events.emit("endRequest")),t.body.enabled&&p.on("data",h=>{if(e.body.raw=Buffer.concat([e.body.raw,Buffer.from(h)]),e.body.raw.byteLength>=t.body.maxSize*1e6){switch(c.statusCode=413,e.continue=!1,typeof t.body.message){case"object":c.setHeader("Content-Type","application/json"),e.content=Buffer.from(JSON.stringify(t.body.message));break;case"string":e.content=Buffer.from(t.body.message);break;case"symbol":e.content=Buffer.from(t.body.message.toString());break;case"bigint":case"number":case"boolean":e.content=Buffer.from(String(t.body.message));break;case"undefined":e.content=Buffer.from("");break}return H({headers:new T(p.headers,decodeURIComponent),rawRes:c},e)}else n.data.incoming.total+=e.body.raw.byteLength,n.data.incoming[e.previousHours[4]]+=e.body.raw.byteLength}).on("end",()=>{e.continue&&e.events.emit("startRequest")}),e.events.once("startRequest",async()=>{var X,Z;if(t.cors&&(c.setHeader("Access-Control-Allow-Headers","*"),c.setHeader("Access-Control-Allow-Origin","*"),c.setHeader("Access-Control-Request-Method","*"),c.setHeader("Access-Control-Allow-Methods",$.join(",")),p.method==="OPTIONS"))return c.end("");let h={},b=e.url.pathname.split("/");for(let s=0;s<=r.length-1;s++){let u=r[s];if(d.has(`route::${e.url.pathname}`)){let g=d.get(`route::${e.url.pathname}`);e.execute.route=g,e.execute.static=g.method==="STATIC",e.execute.exists=!0;break}if(t.dashboard.enabled&&(e.url.pathname===x(t.dashboard.path)||e.url.pathname===x(t.dashboard.path)+"/stats")){e.execute.route={method:"GET",path:u.path,pathArray:u.path.split("/"),code:async g=>{if(g.url.path.endsWith("/stats")){let f=new Date,y=f.getTime(),v=process.cpuUsage(),C=await new Promise(A=>setTimeout(()=>{let B=process.cpuUsage(v),w=(new Date().getTime()-y)*5*a,{user:S,system:I}=B;A((I+S)/w)},500));return g.print({requests:[n.requests.total,{hour:e.previousHours[0],amount:n.requests[e.previousHours[0]]},{hour:e.previousHours[1],amount:n.requests[e.previousHours[1]]},{hour:e.previousHours[2],amount:n.requests[e.previousHours[2]]},{hour:e.previousHours[3],amount:n.requests[e.previousHours[3]]},{hour:e.previousHours[4],amount:n.requests[e.previousHours[4]]}],data:{incoming:[n.data.incoming.total,{hour:e.previousHours[0],amount:n.data.incoming[e.previousHours[0]]},{hour:e.previousHours[1],amount:n.data.incoming[e.previousHours[1]]},{hour:e.previousHours[2],amount:n.data.incoming[e.previousHours[2]]},{hour:e.previousHours[3],amount:n.data.incoming[e.previousHours[3]]},{hour:e.previousHours[4],amount:n.data.incoming[e.previousHours[4]]}],outgoing:[n.data.outgoing.total,{hour:e.previousHours[0],amount:n.data.outgoing[e.previousHours[0]]},{hour:e.previousHours[1],amount:n.data.outgoing[e.previousHours[1]]},{hour:e.previousHours[2],amount:n.data.outgoing[e.previousHours[2]]},{hour:e.previousHours[3],amount:n.data.outgoing[e.previousHours[3]]},{hour:e.previousHours[4],amount:n.data.outgoing[e.previousHours[4]]}]},cpu:{time:`${f.getHours()}:${f.getMinutes()}:${f.getSeconds()}`,usage:C.toFixed(2)},memory:{time:`${f.getHours()}:${f.getMinutes()}:${f.getSeconds()}`,usage:(process.memoryUsage().heapUsed/1e3/1e3).toFixed(2)},routes:r.length,cached:d.objectCount()})}else{let f=(await E.promises.readFile(`${__dirname}/stats/index.html`,"utf8")).replaceAll("/rjweb-dashboard",x(t.dashboard.path));return g.print(f)}},data:{addTypes:!1}},e.execute.static=!1,e.execute.exists=!0,e.execute.dashboard=!0;break}if(!(u.method!=="STATIC"&&u.method!==p.method)&&!(u.method==="STATIC"&&p.method!=="GET")&&u.pathArray.length===b.length){if(e.execute.exists)break;if(u.path===e.url.pathname&&u.method===p.method){e.execute.route=u,e.execute.exists=!0,d.set(`route::${e.url.pathname}`,u);break}if(u.path===e.url.pathname&&u.method==="STATIC"){e.execute.route=u,e.execute.static=!0,e.execute.exists=!0,d.set(`route::${e.url.pathname}`,u);break}for(let g=0;g<=u.pathArray.length-1;g++){let f=u.pathArray[g],y=b[g];if(!f.startsWith(":")&&y!==f)break;if(f===y)continue;if(f.startsWith(":")){h[f.substring(1)]=y,e.execute.route=u,e.execute.exists=!0;continue}}if(e.execute.exists)break}}t.poweredBy&&c.setHeader("X-Powered-By","rjweb-server");let l;t.proxy&&p.headers["x-forwarded-for"]?l=p.headers["x-forwarded-for"]:l=p.socket.remoteAddress;let P={};if(p.headers.cookie&&p.headers.cookie.split(";").forEach(s=>{let u=s.split("=");P[u.shift().trim()]=u.join("=")}),p.headers["content-encoding"]==="gzip"&&(e.body.raw=await new Promise(s=>N.gunzip(e.body.raw,(u,g)=>{s(u?e.body.raw:g)}))),t.body.parse)try{JSON.parse(e.body.raw.toString())}catch(s){e.body.parsed=e.body.raw.toString()}else e.body.parsed=e.body.raw.toString();let i={headers:new T(p.headers,decodeURIComponent),cookies:new T(P,decodeURIComponent),params:new T(h,decodeURIComponent),queries:new T(fe.parse(e.url.query),decodeURIComponent),client:{userAgent:p.headers["user-agent"],httpVersion:p.httpVersion,port:p.socket.remotePort,ip:l},body:e.body.parsed,url:e.url,rawServer:R,rawReq:p,rawRes:c,"@":{},setHeader(s,u){return c.setHeader(s,u),i},setCustom(s,u){return i["@"][s]=u,i},print(s,u){var v,C,A;let g=(v=u==null?void 0:u.niceJSON)!=null?v:!1,f=(C=u==null?void 0:u.contentType)!=null?C:"",y=(A=u==null?void 0:u.returnFunctions)!=null?A:!1;switch(typeof s){case"object":c.setHeader("Content-Type","application/json"),g?e.content=Buffer.from(JSON.stringify(s,void 0,1)):e.content=Buffer.from(JSON.stringify(s));break;case"string":f&&c.setHeader("Content-Type",f),e.content=Buffer.from(s);break;case"symbol":f&&c.setHeader("Content-Type",f),e.content=Buffer.from(s.toString());break;case"bigint":case"number":case"boolean":f&&c.setHeader("Content-Type",f),e.content=Buffer.from(String(s));break;case"function":e.waiting=!0,(async()=>{let B=await s();if(typeof B!="function")i.print(B,{niceJSON:g,contentType:f});else if(y)i.print(B,{niceJSON:g,contentType:f,returnFunctions:y});else return i.error=new Error("Cant return functions from functions, consider using async/await"),m("error",i,e);let U=e.content;e.content=U,e.events.emit("noWaiting")})();break;case"undefined":f&&c.setHeader("Content-Type",f),e.content=Buffer.from("");break}return i},status(s){return c.statusCode=s,i},printFile(s,u){var A,B,U;let g=(A=u==null?void 0:u.addTypes)!=null?A:!0,f=(B=u==null?void 0:u.contentType)!=null?B:"",y=(U=u==null?void 0:u.cache)!=null?U:!1;if(g&&!f?(s.endsWith(".pdf")&&i.setHeader("Content-Type","application/pdf"),s.endsWith(".js")&&i.setHeader("Content-Type","text/javascript"),s.endsWith(".html")&&i.setHeader("Content-Type","text/html"),s.endsWith(".css")&&i.setHeader("Content-Type","text/css"),s.endsWith(".csv")&&i.setHeader("Content-Type","text/csv"),s.endsWith(".mpeg")&&i.setHeader("Content-Type","video/mpeg"),s.endsWith(".mp4")&&i.setHeader("Content-Type","video/mp4"),s.endsWith(".webm")&&i.setHeader("Content-Type","video/webm"),s.endsWith(".bmp")&&i.setHeader("Content-Type","image/bmp")):f&&c.setHeader("Content-Type",f),d.has(`file::${s}`))return n.data.outgoing.total+=d.get(`file::${s}`).byteLength,n.data.outgoing[e.previousHours[4]]+=d.get(`file::${s}`).byteLength,e.content=d.get(`file::${s}`),i;if(d.has(`file::gzip::${s}`))return n.data.outgoing.total+=d.get(`file::gzip::${s}`).byteLength,n.data.outgoing[e.previousHours[4]]+=d.get(`file::gzip::${s}`).byteLength,e.content=d.get(`file::gzip::${s}`),i;let v,C=!1;if(t.compress&&i.headers.has("accept-encoding")&&i.headers.get("accept-encoding").includes("gzip")){i.rawRes.setHeader("Content-Encoding","gzip"),i.rawRes.setHeader("Vary","Accept-Encoding");let w=N.createGzip();try{v=E.createReadStream(s),e.waiting=!0,v.pipe(w),w.pipe(c)}catch(S){C=!0,i.error=S,m("error",i,e)}w.on("data",S=>{var Q;n.data.outgoing.total+=S.byteLength,n.data.outgoing[e.previousHours[4]]+=S.byteLength;let I=(Q=d.get(`file::gzip::${s}`))!=null?Q:Buffer.from("");y&&d.set(`file::gzip::${s}`,Buffer.concat([I,S]))}),w.once("end",()=>{e.events.emit("noWaiting"),e.content=Buffer.from("")}),c.once("close",()=>{v.close(),w.close()})}else{try{v=E.createReadStream(s),e.waiting=!0,v.pipe(c)}catch(w){C=!0,i.error=w,m("error",i,e)}v.on("data",w=>{var I;n.data.outgoing.total+=w.byteLength,n.data.outgoing[e.previousHours[4]]+=w.byteLength;let S=(I=d.get(`file::${s}`))!=null?I:Buffer.from("");y&&d.set(`file::${s}`,Buffer.concat([S,w]))}),v.once("end",()=>{e.events.emit("noWaiting"),e.content=Buffer.from("")}),c.once("close",()=>{v.close()})}return i}},D=!1;if(e.execute.dashboard||(D=await m("request",i,e)),!D){if(t.rateLimits.enabled){for(let s of t.rateLimits.list)if(e.url.pathname.startsWith(s.path)&&(c.setHeader("X-RateLimit-Limit",s.times),c.setHeader("X-RateLimit-Remaining",s.times-((X=await t.rateLimits.functions.get(l+s.path))!=null?X:0)),c.setHeader("X-RateLimit-Reset-Every",s.timeout),await t.rateLimits.functions.set(l+s.path,((Z=await t.rateLimits.functions.get(l+s.path))!=null?Z:0)+1),setTimeout(async()=>{var u;await t.rateLimits.functions.set(l+s.path,((u=await t.rateLimits.functions.get(l+s.path))!=null?u:0)-1)},s.timeout),await t.rateLimits.functions.get(l+s.path)>s.times))return c.statusCode=429,D=!0,i.print(t.rateLimits.message),H(i,e)}if(t.dashboard.enabled&&!e.execute.dashboard&&(n.requests.total++,n.requests[e.previousHours[4]]++),!await new Promise(s=>{if(!e.waiting)return s(!1);e.events.once("noWaiting",()=>s(!1)),e.events.once("endRequest",()=>s(!0))}))if(e.execute.exists&&!D){if(!e.execute.static)await Promise.resolve(e.execute.route.code(i)).catch(s=>{i.error=s,D=!0,m("error",i,e)});else if(e.execute.route.data.addTypes&&(e.execute.route.path.endsWith(".pdf")&&i.setHeader("Content-Type","application/pdf"),e.execute.route.path.endsWith(".js")&&i.setHeader("Content-Type","text/javascript"),e.execute.route.path.endsWith(".html")&&i.setHeader("Content-Type","text/html"),e.execute.route.path.endsWith(".css")&&i.setHeader("Content-Type","text/css"),e.execute.route.path.endsWith(".csv")&&i.setHeader("Content-Type","text/csv"),e.execute.route.path.endsWith(".mpeg")&&i.setHeader("Content-Type","video/mpeg"),e.execute.route.path.endsWith(".mp4")&&i.setHeader("Content-Type","video/mp4"),e.execute.route.path.endsWith(".webm")&&i.setHeader("Content-Type","video/webm"),e.execute.route.path.endsWith(".bmp")&&i.setHeader("Content-Type","image/bmp")),"content"in e.execute.route.data)n.data.outgoing.total+=e.execute.route.data.content.byteLength,n.data.outgoing[e.previousHours[4]]+=e.execute.route.data.content.byteLength,e.content=e.execute.route.data.content;else{let s=pe.resolve(e.execute.route.data.file),u,g=!1;if(t.compress&&i.headers.has("accept-encoding")&&i.headers.get("accept-encoding").includes("gzip")){i.rawRes.setHeader("Content-Encoding","gzip"),i.rawRes.setHeader("Vary","Accept-Encoding");let f=N.createGzip();try{u=E.createReadStream(s),e.waiting=!0,u.pipe(f),f.pipe(c)}catch(y){g=!0,i.error=y,m("error",i,e)}f.on("data",y=>{n.data.outgoing.total+=y.byteLength,n.data.outgoing[e.previousHours[4]]+=y.byteLength}),f.once("end",()=>{e.events.emit("noWaiting"),e.content=Buffer.from("")}),c.once("close",()=>{u.close(),f.close()})}else{try{u=E.createReadStream(s),e.waiting=!0,u.pipe(c)}catch(f){g=!0,i.error=f,m("error",i,e)}u.on("data",f=>{n.data.outgoing.total+=f.byteLength,n.data.outgoing[e.previousHours[4]]+=f.byteLength}),u.once("end",()=>{e.events.emit("noWaiting"),e.content=Buffer.from("")}),c.once("close",()=>{u.close()})}if(g)return i}await new Promise(s=>{if(!e.waiting)return s(!0);e.events.once("noWaiting",()=>s(!1))}),e.content?(n.data.outgoing.total+=e.content.byteLength,n.data.outgoing[e.previousHours[4]]+=e.content.byteLength,H(i,e)):c.end()}else m("notfound",i,e),await new Promise(s=>{if(!e.waiting)return s(!0);e.events.once("noWaiting",()=>s(!1))}),e.content?(n.data.outgoing.total+=e.content.byteLength,n.data.outgoing[e.previousHours[4]]+=e.content.byteLength,H(i,e)):c.end()}}),t.body.enabled||e.events.emit("startRequest")});return R.listen(t.port,t.bind),new Promise((p,c)=>{R.once("listening",()=>p({success:!0,port:t.port,message:"WEBSERVER STARTED",rawServer:R})),R.once("error",e=>{R.close(),c({success:!1,error:e,message:"WEBSERVER ERRORED"})})})}}});import*as O from"fs";import*as M from"path";var te="2.8.0";var _=Re(he()),L={dashboard:{}},k=process.argv.slice(2);if(k.includes("-v")||k.includes("--version"))console.log("[RJW] Version:"),console.log(`v${te}`);else if(O.existsSync(M.join(process.cwd(),k[0]))){let t=!1,r=!0;for(let o of k.slice(1)){let[a,d]=o.slice(2).split("=");a==="port"&&(L.port=Number(d)),a==="bind"&&(L.bind=d),a==="remHTML"&&(t=Boolean(d)),a==="addTypes"&&(t=Boolean(d)),a==="compress"&&(L.compress=Boolean(d)),a==="dashboard"&&(L.dashboard.enabled=Boolean(d))}L.routes=new _.default.routeList,L.routes.static("/",M.join(process.cwd(),k[0]),{remHTML:t,addTypes:r}),L.routes.event("request",async o=>{console.log(`[RJW] [${o.url.method}] ${o.url.href} FROM ${o.client.ip}`)}),_.default.start(L).then(o=>{console.log(`[RJW] Server started on port ${o.port}`)})}else O.existsSync(M.join(process.cwd(),k[0]))?(console.log("[RJW] Help:"),console.log("rjw-srv [folder] [options]"),console.log(""),console.log("Options:"),console.log("--port=2023"),console.log("--compress=false"),console.log('--bind="0.0.0.0"'),console.log("--remHTML=false"),console.log("--addTypes=true"),console.log("--dashboard=false")):(console.log("[RJW] Error:"),console.log(`Folder "${M.join(process.cwd(),k[0])}" couldnt be found`));
