var ge=Object.create;var ee=Object.defineProperty;var be=Object.getOwnPropertyDescriptor;var Te=Object.getOwnPropertyNames;var ve=Object.getPrototypeOf,Ee=Object.prototype.hasOwnProperty;var te=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,a)=>(typeof require<"u"?require:t)[a]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var $=(e,t)=>()=>(e&&(t=e(e=0)),t);var re=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Re=(e,t,a,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of Te(t))!Ee.call(e,l)&&l!==a&&ee(e,l,{get:()=>t[l],enumerable:!(c=be(t,l))||c.enumerable});return e};var se=(e,t,a)=>(a=e!=null?ge(ve(e)):{},Re(t||!e||!e.__esModule?ee(a,"default",{value:e,enumerable:!0}):a,e));import*as I from"fs";var N,ae,ne=$(()=>{N=(e,t)=>(t=t||[],I.readdirSync(e).forEach(c=>{if(I.statSync(e+"/"+c).isDirectory())t=N(e+"/"+c,t);else{let l=e+"/"+c;t.push(l)}}),t),ae=(e,t,a)=>(a=a||[],a=N(e,a).filter(c=>c.endsWith(t)),a)});var j=re((xe,ie)=>{ie.exports=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});import*as oe from"path";import*as ce from"fs";var P,M,k,le=$(()=>{ne();P=se(j()),M=e=>(e=e.replace(/\/{2,}/g,"/"),e.endsWith("/")&&e!=="/"?e.slice(0,-1):!e.startsWith("/")&&e!=="/"?`/${e}`:e),k=class{constructor(t,a){t=t!=null?t:[],a=a!=null?a:[],this.routes=t,this.events=a}event(t,a){return this.events.some(c=>c.event===t)?!1:this.events.push({event:t,code:a})-1}set(t,a,c){if(a=M(a),!P.default.includes(t))throw TypeError(`No Valid Request Type: ${t}
Possible Values: ${P.default.join(", ")}`);return this.routes.some(l=>l.method===t&&l.path===a)?!1:this.routes.push({method:t,path:a,pathArray:a.split("/"),code:c,data:{addTypes:!1}})-1}static(t,a,c){var L,H,g;t=M(t);let l=(L=c==null?void 0:c.preload)!=null?L:!1,f=(H=c==null?void 0:c.remHTML)!=null?H:!1,O=(g=c==null?void 0:c.addTypes)!=null?g:!0,y=[];for(let b of N(a)){let w=b.replace(a,"").replace("/",""),W=t+a.replace(w,"").replace(a,"").slice(0,-1);f&&w.endsWith("index.html")?w=w.slice(0,-10):f&&w.endsWith(".html")?w.slice(0,-5):f&&w.endsWith(".htm")&&w.slice(0,-4);let R=M(`${W}/${w}`),S=this.routes.push({method:"STATIC",path:R,pathArray:R.split("/"),code:async()=>{},data:{addTypes:O,file:b}});l&&(this.routes[S-1].data.content=ce.readFileSync(b)),y.push(S-1)}return y}load(t){let a=ae(t,".js"),c=[];for(let l of a){let f=te(oe.resolve(l));if(!(!("path"in f)||!("method"in f)||!("code"in f))){if(!P.default.includes(f.method))throw TypeError(`No Valid Request Type: ${f.method}
Possible Values: ${P.default.join(", ")}`);c.push(this.routes.push({method:f.method,path:f.path,pathArray:f.path.split("/"),code:f.code,data:{addTypes:!1}}))-1}}return c}list(){return{routes:this.routes,events:this.events}}}});var de,ue,fe=$(()=>{de=(y=>(y.options="OPTIONS",y.delete="DELETE",y.patch="PATCH",y.post="POST",y.put="PUT",y.get="GET",y.static="STATIC",y))(de||{}),ue=de});import*as me from"path";import*as pe from"http";import*as ye from"url";import*as D from"fs";var Se=re((Ne,we)=>{le();fe();var he=se(j());we.exports={routeList:k,types:ue,async start(e){var w,W,R,S,V,G,J,X,F,z,K;let t=(W=(w=e==null?void 0:e.routes)==null?void 0:w.list().routes)!=null?W:[],a=(S=(R=e==null?void 0:e.routes)==null?void 0:R.list().events)!=null?S:[],c=(V=e==null?void 0:e.proxy)!=null?V:!1,l=(G=e==null?void 0:e.rateLimits)!=null?G:{enabled:!1,list:[]},f=(J=e==null?void 0:e.bind)!=null?J:"0.0.0.0",O=(X=e==null?void 0:e.cors)!=null?X:!1,y=(F=e==null?void 0:e.port)!=null?F:2023,L=(z=e==null?void 0:e.maxBody)!=null?z:20,H=(K=e==null?void 0:e.poweredBy)!=null?K:!0,g=async(u,r)=>{switch(u){case"error":{let h=a.find(d=>d.event==="error");h?Promise.resolve(h.code(r)).catch(d=>{console.log(d),r.status(500),r.rawRes.write(`An Error occured in your Error Event (what the hell?)
`),r.rawRes.write(d.stack),r.rawRes.end()}).then(()=>r.rawRes.end()):(console.log(r.error),r.rawRes.write(`An Error occurred
`),r.rawRes.write(r.error.stack),r.status(500),r.rawRes.end())}case"request":{let h=!1,d=a.find(i=>i.event==="request");return d&&await Promise.resolve(d.code(r)).catch(i=>{h=!0,console.log(i),r.status(500),r.rawRes.write(`An Error occured in your Request Event
`),r.rawRes.write(i.stack),r.rawRes.end()}),h}case"notfound":{let h=!1,d=a.find(i=>i.event==="notfound");if(d)await Promise.resolve(d.code(r)).catch(i=>{h=!0,console.log(i),r.status(500),r.rawRes.write(`An Error occured in your NotFound Event
`),r.rawRes.write(i.stack),r.rawRes.end()}).then(()=>r.rawRes.end());else{let i="";for(let E of t){let v=E.method==="STATIC"?"GET":E.method;i+=`[-] [${v}] ${E.path}
`}r.status(404),r.rawRes.write(`[!] COULDNT FIND ${r.url.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${i}`),r.rawRes.end()}return h}}},b=pe.createServer(async(u,r)=>{let h="";if(u.headers["content-length"]&&parseInt(u.headers["content-length"])>=L*1e6)return r.statusCode=413,r.write("Payload Too Large"),r.end();u.on("data",d=>{h+=d}).on("end",async()=>{var Z,_,q;let d={...ye.parse(u.url),method:u.method};d.path.endsWith("/")&&(d.path=d.path.slice(0,-1));let i;try{h=JSON.parse(h)}catch(s){}if(O&&(r.setHeader("Access-Control-Allow-Headers","*"),r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Request-Method","*"),r.setHeader("Access-Control-Allow-Methods",he.default.join(",")),u.method==="OPTIONS"))return r.end("");let E=new Map,v,B=!1,A=d.pathname.split("/");A[A.length-1]===""&&A.pop();for(let s=1;s<=t.length-1;s++){let n=t[s];if(n.path===d.pathname&&n.method===u.method){i=s,B=!1,v=!0;break}else if(n.path===d.pathname&&n.method==="STATIC"){i=s,B=!0,v=!0;break}if(n.method===u.method&&n.pathArray.length===A.length){if(v&&n.path!==t[i].path)break;for(let p=1;p<=n.pathArray.length-1;p++){let m=n.pathArray[p],x=A[p];if(!m.startsWith(":")&&x!==m)break;if(m!==x&&m.startsWith(":")){E.set(m.replace(":",""),decodeURIComponent(x)),i=s,v=!0;continue}}}}let T;c&&u.headers["x-forwarded-for"]?T=u.headers["x-forwarded-for"]:T=u.socket.remoteAddress;let U=new Map;Object.keys(u.headers).forEach(s=>{U.set(s,u.headers[s])}),U.delete("cookie");let Q=new Map;for(let[s,n]of new URLSearchParams(d.search))Q.set(s,n);let Y=new Map;u.headers.cookie&&u.headers.cookie.split(";").forEach(s=>{let[n,...p]=s.split("=");if(n=n==null?void 0:n.trim(),!n)return;let m=p.join("=").trim();m&&Y.set(n,decodeURIComponent(m))}),H&&r.setHeader("X-Powered-By","rjweb-server");let o={headers:U,cookies:Y,params:E,queries:Q,client:{port:u.socket.remotePort,ip:T},body:h,url:d,rawServer:b,rawReq:u,rawRes:r,"@":{},setHeader(s,n){return r.setHeader(s,n),o},setCustom(s,n){return o["@"][s]=n,o},print(s,n){var m;let p=(m=n==null?void 0:n.niceJSON)!=null?m:!1;switch(typeof s){case"object":r.setHeader("Content-Type","application/json"),p?r.write(JSON.stringify(s,void 0,1)):r.write(JSON.stringify(s));break;case"bigint":case"number":case"boolean":r.write(s.toString());break;case"function":r.write(s());break;case"undefined":r.write("");break;default:try{r.write(s)}catch(x){o.error=x,C=!0,g("error",o)}}return o},status(s){return r.statusCode=s,o},printFile(s){let n,p=!1;try{n=D.readFileSync(s)}catch(m){p=!0,o.error=m,g("error",o)}return p||r.write(n,"binary"),o}},C=await g("request",o);if(!C){if(l.enabled){for(let s of l.list)if(d.path.startsWith(s.path)&&(r.setHeader("X-RateLimit-Limit",s.times),r.setHeader("X-RateLimit-Remaining",s.times-((Z=await l.functions.get(T+s.path))!=null?Z:0)),r.setHeader("X-RateLimit-Reset-Every",s.timeout),await l.functions.set(T+s.path,((_=await l.functions.get(T+s.path))!=null?_:0)+1),setTimeout(async()=>{var n;await l.functions.set(T+s.path,((n=await l.functions.get(T+s.path))!=null?n:0)-1)},s.timeout),await l.functions.get(T+s.path)>s.times))return r.statusCode=429,C=!0,o.print((q=l.message)!=null?q:"Rate Limited"),r.end()}if(v&&!C)if(!B)Promise.resolve(t[i].code(o)).catch(s=>{o.error=s,C=!0,g("error",o)}).then(()=>r.end());else{if(t[i].data.addTypes&&(t[i].path.endsWith(".pdf")&&o.setHeader("Content-Type","application/pdf"),t[i].path.endsWith(".js")&&o.setHeader("Content-Type","text/javascript"),t[i].path.endsWith(".html")&&o.setHeader("Content-Type","text/html"),t[i].path.endsWith(".css")&&o.setHeader("Content-Type","text/css"),t[i].path.endsWith(".csv")&&o.setHeader("Content-Type","text/csv"),t[i].path.endsWith(".mpeg")&&o.setHeader("Content-Type","video/mpeg"),t[i].path.endsWith(".mp4")&&o.setHeader("Content-Type","video/mp4"),t[i].path.endsWith(".webm")&&o.setHeader("Content-Type","video/webm"),t[i].path.endsWith(".bmp")&&o.setHeader("Content-Type","image/bmp")),!("content"in t[i].data)){let s=me.resolve(t[i].data.file),n,p=!1;try{n=D.readFileSync(s)}catch(m){p=!0,o.error=m,g("error",o)}return p?void 0:(r.write(n,"binary"),r.end())}return r.write(t[i].data.content,"binary"),r.end()}else g("notfound",o)}})});return b.listen(y,f),new Promise((u,r)=>{b.once("listening",()=>u({success:!0,port:y,message:"WEBSERVER STARTED",rawServer:b})),b.once("error",h=>r({success:!1,error:h,message:"WEBSERVER ERRORED"}))})}}});export default Se();
