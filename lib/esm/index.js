var Re=Object.create;var ne=Object.defineProperty;var Se=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var Ae=Object.getPrototypeOf,xe=Object.prototype.hasOwnProperty;var ie=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var M=(e,t)=>()=>(e&&(t=e(e=0)),t);var oe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var He=(e,t,i,d)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of Ce(t))!xe.call(e,c)&&c!==i&&ne(e,c,{get:()=>t[c],enumerable:!(d=Se(t,c))||d.enumerable});return e};var de=(e,t,i)=>(i=e!=null?Re(Ae(e)):{},He(t||!e||!e.__esModule?ne(i,"default",{value:e,enumerable:!0}):i,e));import*as P from"fs";var I,ce,ue=M(()=>{I=(e,t)=>(t=t||[],P.readdirSync(e).forEach(d=>{if(P.statSync(e+"/"+d).isDirectory())t=I(e+"/"+d,t);else{let c=e+"/"+d;t.push(c)}}),t),ce=(e,t,i)=>(i=i||[],i=I(e,i).filter(d=>d.endsWith(t)),i)});var U=oe((Pe,le)=>{le.exports=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});import*as E from"path";import*as fe from"fs";var H,N,W,he=M(()=>{ue();H=de(U()),N=e=>(e=e.replace(/\/{2,}/g,"/"),e.endsWith("/")&&e!=="/"?e.slice(0,-1):!e.startsWith("/")&&e!=="/"?`/${e}`:e),W=class{constructor(t,i){t=t!=null?t:[],i=i!=null?i:[],this.routes=t,this.events=i}event(t,i){return this.events.some(d=>d.event===t)?!1:this.events.push({event:t,code:i})-1}set(t,i,d){if(i=N(i),!H.default.includes(t))throw TypeError(`No Valid Request Type: ${t}
Possible Values: ${H.default.join(", ")}`);return this.routes.some(c=>c.method===t&&c.path===i)?!1:this.routes.push({method:t,path:i,pathArray:i.split("/"),code:d,data:{addTypes:!1}})-1}static(t,i,d){var k,L,R;t=N(t);let c=(k=d==null?void 0:d.preload)!=null?k:!1,h=(L=d==null?void 0:d.remHTML)!=null?L:!1,O=(R=d==null?void 0:d.addTypes)!=null?R:!0,y=[];for(let b of I(i)){let f=E.parse(b.replace(i,""));h&&f.base==="index.html"?f.base="":h&&f.ext===".html"?f.base=f.base.slice(0,-5):h&&f.ext===".htm"&&(f.base=f.base.slice(0,-4));let C=this.routes.push({method:"STATIC",path:E.join(f.dir,f.base),pathArray:E.join(f.dir,f.base).split("/"),code:async()=>{},data:{addTypes:O,file:b}});c&&(this.routes[C-1].data.content=fe.readFileSync(b)),y.push(C-1)}return y}load(t){let i=ce(t,".js"),d=[];for(let c of i){let h=ie(E.resolve(c));if(!(!("path"in h)||!("method"in h)||!("code"in h))){if(!H.default.includes(h.method))throw TypeError(`No Valid Request Type: ${h.method}
Possible Values: ${H.default.join(", ")}`);d.push(this.routes.push({method:h.method,path:h.path,pathArray:h.path.split("/"),code:h.code,data:{addTypes:!1}}))-1}}return d}list(){return{routes:this.routes,events:this.events}}}});var me,pe,ye=M(()=>{me=(y=>(y.options="OPTIONS",y.delete="DELETE",y.patch="PATCH",y.post="POST",y.put="PUT",y.get="GET",y.static="STATIC",y))(me||{}),pe=me});import*as be from"path";import*as Te from"http";import*as ge from"url";import*as D from"fs";var We=oe((Ue,ve)=>{he();ye();var we=de(U());ve.exports={routeList:W,types:pe,async start(e){var C,$,V,G,J,X,F,z,K,Q,Y;let t=($=(C=e==null?void 0:e.routes)==null?void 0:C.list().routes)!=null?$:[],i=(G=(V=e==null?void 0:e.routes)==null?void 0:V.list().events)!=null?G:[],d=(J=e==null?void 0:e.proxy)!=null?J:!1,c=(X=e==null?void 0:e.rateLimits)!=null?X:{enabled:!1,list:[]},h=(F=e==null?void 0:e.bind)!=null?F:"0.0.0.0",O=(z=e==null?void 0:e.cors)!=null?z:!1,y=(K=e==null?void 0:e.port)!=null?K:2023,k=(Q=e==null?void 0:e.maxBody)!=null?Q:20,L=(Y=e==null?void 0:e.poweredBy)!=null?Y:!0,R=new Map,b=async(l,r)=>{switch(l){case"error":{let m=i.find(u=>u.event==="error");m?Promise.resolve(m.code(r)).catch(u=>{console.log(u),r.status(500),r.rawRes.write(`An Error occured in your Error Event (what the hell?)
`),r.rawRes.write(u.stack),r.rawRes.end()}).then(()=>r.rawRes.end()):(console.log(r.error),r.rawRes.write(`An Error occurred
`),r.rawRes.write(r.error.stack),r.status(500),r.rawRes.end())}case"request":{let m=!1,u=i.find(o=>o.event==="request");return u&&await Promise.resolve(u.code(r)).catch(o=>{m=!0,console.log(o),r.status(500),r.rawRes.write(`An Error occured in your Request Event
`),r.rawRes.write(o.stack),r.rawRes.end()}),m}case"notfound":{let m=!1,u=i.find(o=>o.event==="notfound");if(u)await Promise.resolve(u.code(r)).catch(o=>{m=!0,console.log(o),r.status(500),r.rawRes.write(`An Error occured in your NotFound Event
`),r.rawRes.write(o.stack),r.rawRes.end()}).then(()=>r.rawRes.end());else{let o="";for(let S of t){let v=S.method==="STATIC"?"GET":S.method;o+=`[-] [${v}] ${S.path}
`}r.status(404),r.rawRes.write(`[!] COULDNT FIND ${r.url.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${o}`),r.rawRes.end()}return m}}},f=Te.createServer(async(l,r)=>{let m="";if(l.headers["content-length"]&&Number(l.headers["content-length"])>=k*1e6)return r.statusCode=413,r.write("Payload Too Large"),r.end();l.on("data",u=>{m+=u}).on("end",async()=>{var q,ee,te;let u={...ge.parse(l.url),method:l.method};u.path=N(u.path);let o;try{m=JSON.parse(m)}catch(s){}if(O&&(r.setHeader("Access-Control-Allow-Headers","*"),r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Request-Method","*"),r.setHeader("Access-Control-Allow-Methods",we.default.join(",")),l.method==="OPTIONS"))return r.end("");let S=new Map,v,j=!1,A=u.pathname.split("/");A[A.length-1]===""&&A.pop();for(let s=1;s<=t.length-1;s++){let a=t[s];if(a.path===u.pathname&&a.method===l.method){o=s,j=!1,v=!0;break}else if(a.path===u.pathname&&a.method==="STATIC"){o=s,j=!0,v=!0;break}if(a.method===l.method&&a.pathArray.length===A.length){if(v&&a.path!==t[o].path)break;for(let w=1;w<=a.pathArray.length-1;w++){let p=a.pathArray[w],g=A[w];if(!p.startsWith(":")&&g!==p)break;if(p!==g&&p.startsWith(":")){S.set(p.replace(":",""),decodeURIComponent(g)),o=s,v=!0;continue}}}}let T;d&&l.headers["x-forwarded-for"]?T=l.headers["x-forwarded-for"]:T=l.socket.remoteAddress;let B=new Map;Object.keys(l.headers).forEach(s=>{B.set(s,l.headers[s])}),B.delete("cookie");let Z=new Map;for(let[s,a]of new URLSearchParams(u.search))Z.set(s,a);let _=new Map;l.headers.cookie&&l.headers.cookie.split(";").forEach(s=>{let[a,...w]=s.split("=");if(a=a==null?void 0:a.trim(),!a)return;let p=w.join("=").trim();p&&_.set(a,decodeURIComponent(p))}),L&&r.setHeader("X-Powered-By","rjweb-server");let n={headers:B,cookies:_,params:S,queries:Z,client:{port:l.socket.remotePort,ip:T},body:m,url:u,rawServer:f,rawReq:l,rawRes:r,"@":{},setHeader(s,a){return r.setHeader(s,a),n},setCustom(s,a){return n["@"][s]=a,n},print(s,a){var p;let w=(p=a==null?void 0:a.niceJSON)!=null?p:!1;switch(typeof s){case"object":r.setHeader("Content-Type","application/json"),w?r.write(JSON.stringify(s,void 0,1)):r.write(JSON.stringify(s));break;case"bigint":case"number":case"boolean":r.write(s.toString());break;case"function":r.write(s());break;case"undefined":r.write("");break;default:try{r.write(s)}catch(g){n.error=g,x=!0,b("error",n)}}return n},status(s){return r.statusCode=s,n},printFile(s,a){var se,ae;let w=(se=a==null?void 0:a.addTypes)!=null?se:!0,p=(ae=a==null?void 0:a.cache)!=null?ae:!1;if(w&&(s.endsWith(".pdf")&&n.setHeader("Content-Type","application/pdf"),s.endsWith(".js")&&n.setHeader("Content-Type","text/javascript"),s.endsWith(".html")&&n.setHeader("Content-Type","text/html"),s.endsWith(".css")&&n.setHeader("Content-Type","text/css"),s.endsWith(".csv")&&n.setHeader("Content-Type","text/csv"),s.endsWith(".mpeg")&&n.setHeader("Content-Type","video/mpeg"),s.endsWith(".mp4")&&n.setHeader("Content-Type","video/mp4"),s.endsWith(".webm")&&n.setHeader("Content-Type","video/webm"),s.endsWith(".bmp")&&n.setHeader("Content-Type","image/bmp")),R.has(s))return r.write(R.get(s),"binary"),n;let g,re=!1;try{g=D.readFileSync(s)}catch(Ee){re=!0,n.error=Ee,b("error",n)}return re||(p&&R.set(s,g),r.write(g,"binary")),n}},x=await b("request",n);if(!x){if(c.enabled){for(let s of c.list)if(u.path.startsWith(s.path)&&(r.setHeader("X-RateLimit-Limit",s.times),r.setHeader("X-RateLimit-Remaining",s.times-((q=await c.functions.get(T+s.path))!=null?q:0)),r.setHeader("X-RateLimit-Reset-Every",s.timeout),await c.functions.set(T+s.path,((ee=await c.functions.get(T+s.path))!=null?ee:0)+1),setTimeout(async()=>{var a;await c.functions.set(T+s.path,((a=await c.functions.get(T+s.path))!=null?a:0)-1)},s.timeout),await c.functions.get(T+s.path)>s.times))return r.statusCode=429,x=!0,n.print((te=c.message)!=null?te:"Rate Limited"),r.end()}if(v&&!x)if(!j)Promise.resolve(t[o].code(n)).catch(s=>{n.error=s,x=!0,b("error",n)}).then(()=>r.end());else{if(t[o].data.addTypes&&(t[o].path.endsWith(".pdf")&&n.setHeader("Content-Type","application/pdf"),t[o].path.endsWith(".js")&&n.setHeader("Content-Type","text/javascript"),t[o].path.endsWith(".html")&&n.setHeader("Content-Type","text/html"),t[o].path.endsWith(".css")&&n.setHeader("Content-Type","text/css"),t[o].path.endsWith(".csv")&&n.setHeader("Content-Type","text/csv"),t[o].path.endsWith(".mpeg")&&n.setHeader("Content-Type","video/mpeg"),t[o].path.endsWith(".mp4")&&n.setHeader("Content-Type","video/mp4"),t[o].path.endsWith(".webm")&&n.setHeader("Content-Type","video/webm"),t[o].path.endsWith(".bmp")&&n.setHeader("Content-Type","image/bmp")),!("content"in t[o].data)){let s=be.resolve(t[o].data.file),a,w=!1;try{a=D.readFileSync(s)}catch(p){w=!0,n.error=p,b("error",n)}return w?void 0:(r.write(a,"binary"),r.end())}return r.write(t[o].data.content,"binary"),r.end()}else b("notfound",n)}})});return f.listen(y,h),new Promise((l,r)=>{f.once("listening",()=>l({success:!0,port:y,message:"WEBSERVER STARTED",rawServer:f})),f.once("error",m=>r({success:!1,error:m,message:"WEBSERVER ERRORED"}))})}}});export default We();
