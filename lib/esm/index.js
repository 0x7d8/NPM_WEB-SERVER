var ge=Object.create;var q=Object.defineProperty;var be=Object.getOwnPropertyDescriptor;var Te=Object.getOwnPropertyNames;var ve=Object.getPrototypeOf,Ee=Object.prototype.hasOwnProperty;var ee=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,a)=>(typeof require<"u"?require:e)[a]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var U=(t,e)=>()=>(t&&(e=t(t=0)),e);var te=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Re=(t,e,a,c)=>{if(e&&typeof e=="object"||typeof e=="function")for(let l of Te(e))!Ee.call(t,l)&&l!==a&&q(t,l,{get:()=>e[l],enumerable:!(c=be(e,l))||c.enumerable});return t};var re=(t,e,a)=>(a=t!=null?ge(ve(t)):{},Re(e||!t||!t.__esModule?q(a,"default",{value:t,enumerable:!0}):a,t));import*as I from"fs";var N,se,ae=U(()=>{N=(t,e)=>(e=e||[],I.readdirSync(t).forEach(c=>{if(I.statSync(t+"/"+c).isDirectory())e=N(t+"/"+c,e);else{let l=t+"/"+c;e.push(l)}}),e),se=(t,e,a)=>(a=a||[],a=N(t,a).filter(c=>c.endsWith(e)),a)});var j=te((xe,ne)=>{ne.exports=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});import*as oe from"path";import*as ce from"fs";var k,ie,L,le=U(()=>{ae();k=re(j()),ie=t=>(t=t.replace(/\/{2,}/g,"/"),t.endsWith("/")?t.slice(0,-1):t.startsWith("/")?t:`/${t}`),L=class{constructor(e,a){e=e!=null?e:[],a=a!=null?a:[],this.routes=e,this.events=a}event(e,a){return this.events.some(c=>c.event===e)?!1:this.events.push({event:e,code:a})}set(e,a,c){if(a=ie(a),!k.default.includes(e))throw TypeError(`No Valid Request Type: ${e}
Possible Values: ${k.default.join(", ")}`);return this.routes.some(l=>l.method===e&&l.path===a)?!1:this.routes.push({method:e,path:a,pathArray:a.split("/"),code:c,data:{addTypes:!1}})}static(e,a,c){var W,H,b;e=ie(e);let l=(W=c==null?void 0:c.preload)!=null?W:!1,f=(H=c==null?void 0:c.remHTML)!=null?H:!1,$=(b=c==null?void 0:c.addTypes)!=null?b:!0,w=[];for(let T of N(a)){let h=T.replace(a,"").replace("/",""),g=e+a.replace(h,"").replace(a,"").slice(0,-1);g.startsWith(".")&&(g=g.slice(-1)),f&&h==="index.html"?h="":f&&h.endsWith(".html")?h=h.slice(0,-5):f&&h.endsWith(".htm")&&(h=h.slice(0,-4));let S=`${g}/${h}`.endsWith("/")?`${g}`:`${g}`=="/"?`/${h}`:`${g}/${h}`,A=this.routes.push({method:"STATIC",path:S,pathArray:S.split("/"),code:async()=>null,data:{addTypes:$,file:T}});l&&(this.routes[A].data.content=ce.readFileSync(T)),w.push(A)}return w}load(e){let a=se(e,".js"),c=[];for(let l of a){let f=ee(oe.resolve(l));if(!(!("path"in f)||!("type"in f)||!("code"in f))){if(!k.default.includes(f.type))throw TypeError(`No Valid Request Type: ${f.type}
Possible Values: ${k.default.join(", ")}`);c.push(this.routes.push({method:f.type,path:f.path,pathArray:f.path.split("/"),code:f.code,data:{addTypes:!1}}))}}return c}list(){return{routes:this.routes,events:this.events}}}});var de,ue,fe=U(()=>{de=(w=>(w.options="OPTIONS",w.delete="DELETE",w.patch="PATCH",w.post="POST",w.put="PUT",w.get="GET",w.static="STATIC",w))(de||{}),ue=de});import*as me from"path";import*as pe from"http";import*as ye from"url";import*as M from"fs";var Se=te((Ne,we)=>{le();fe();var he=re(j());we.exports={routeList:L,types:ue,async start(t){var h,g,S,A,D,V,G,J,X,F,z;let e=(g=(h=t==null?void 0:t.routes)==null?void 0:h.list().routes)!=null?g:[],a=(A=(S=t==null?void 0:t.routes)==null?void 0:S.list().events)!=null?A:[],c=(D=t==null?void 0:t.proxy)!=null?D:!1,l=(V=t==null?void 0:t.rateLimits)!=null?V:{enabled:!1,list:[]},f=(G=t==null?void 0:t.bind)!=null?G:"0.0.0.0",$=(J=t==null?void 0:t.cors)!=null?J:!1,w=(X=t==null?void 0:t.port)!=null?X:2023,W=(F=t==null?void 0:t.maxBody)!=null?F:20,H=(z=t==null?void 0:t.poweredBy)!=null?z:!0,b=async(u,r)=>{switch(u){case"error":{let m=a.find(d=>d.event==="error");m?Promise.resolve(m.code(r)).catch(d=>{console.log(d),r.status(500),r.rawRes.write(`An Error occured in your Error Event (what the hell?)
`),r.rawRes.write(d.stack),r.rawRes.end()}).then(()=>r.rawRes.end()):(console.log(r.error),r.rawRes.write(`An Error occurred
`),r.rawRes.write(r.error.stack),r.status(500),r.rawRes.end())}case"request":{let m=!1,d=a.find(i=>i.event==="request");return d&&await Promise.resolve(d.code(r)).catch(i=>{m=!0,console.log(i),r.status(500),r.rawRes.write(`An Error occured in your Request Event
`),r.rawRes.write(i.stack),r.rawRes.end()}),m}case"notfound":{let m=!1,d=a.find(i=>i.event==="notfound");if(d)await Promise.resolve(d.code(r)).catch(i=>{m=!0,console.log(i),r.status(500),r.rawRes.write(`An Error occured in your NotFound Event
`),r.rawRes.write(i.stack),r.rawRes.end()}).then(()=>r.rawRes.end());else{let i="";for(let R of e){let E=R.method==="STATIC"?"GET":R.method;i+=`[-] [${E}] ${R.path}
`}r.status(404),r.rawRes.write(`[!] COULDNT FIND ${r.url.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${i}`),r.rawRes.end()}return m}}},T=pe.createServer(async(u,r)=>{let m="";if(u.headers["content-length"]&&parseInt(u.headers["content-length"])>=W*1e6)return r.statusCode=413,r.write("Payload Too Large"),r.end();u.on("data",d=>{m+=d}).on("end",async()=>{var Y,Z,_;let d={...ye.parse(u.url),method:u.method};d.path.endsWith("/")&&(d.path=d.path.slice(0,-1));let i;try{m=JSON.parse(m)}catch(s){}if($&&(r.setHeader("Access-Control-Allow-Headers","*"),r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Request-Method","*"),r.setHeader("Access-Control-Allow-Methods",he.default.join(",")),u.method==="OPTIONS"))return r.end("");let R=new Map,E,O=!1,C=d.pathname.split("/");C[C.length-1]===""&&C.pop();for(let s=1;s<=e.length-1;s++){let n=e[s];if(n.path===d.pathname&&n.method===u.method){i=s,O=!1,E=!0;break}else if(n.path===d.pathname&&n.method==="STATIC"){i=s,O=!0,E=!0;break}if(n.method===u.method&&n.pathArray.length===C.length){if(E&&n.path!==e[i].path)break;for(let y=1;y<=n.pathArray.length-1;y++){let p=n.pathArray[y],P=C[y];if(!p.startsWith(":")&&P!==p)break;if(p!==P&&p.startsWith(":")){R.set(p.replace(":",""),decodeURIComponent(P)),i=s,E=!0;continue}}}}let v;c&&u.headers["x-forwarded-for"]?v=u.headers["x-forwarded-for"]:v=u.socket.remoteAddress;let B=new Map;Object.keys(u.headers).forEach(s=>{B.set(s,u.headers[s])}),B.delete("cookie");let K=new Map;for(let[s,n]of new URLSearchParams(d.search))K.set(s,n);let Q=new Map;u.headers.cookie&&u.headers.cookie.split(";").forEach(s=>{let[n,...y]=s.split("=");if(n=n==null?void 0:n.trim(),!n)return;let p=y.join("=").trim();p&&Q.set(n,decodeURIComponent(p))}),H&&r.setHeader("X-Powered-By","rjweb-server");let o={headers:B,cookies:Q,params:R,queries:K,client:{port:u.socket.remotePort,ip:v},body:m,url:d,rawServer:T,rawReq:u,rawRes:r,"@":{},setHeader(s,n){return r.setHeader(s,n),o},setCustom(s,n){return o["@"][s]=n,o},print(s,n){var p;let y=(p=n==null?void 0:n.niceJSON)!=null?p:!1;switch(typeof s){case"object":r.setHeader("Content-Type","application/json"),y?r.write(JSON.stringify(s,void 0,1)):r.write(JSON.stringify(s));break;case"bigint":case"number":case"boolean":r.write(s.toString());break;case"function":r.write(s());break;case"undefined":r.write("");break;default:try{r.write(s)}catch(P){o.error=P,x=!0,b("error",o)}}return o},status(s){return r.statusCode=s,o},printFile(s){let n,y=!1;try{n=M.readFileSync(s)}catch(p){y=!0,o.error=p,b("error",o)}return y||r.write(n,"binary"),o}},x=await b("request",o);if(!x){if(l.enabled){for(let s of l.list)if(d.path.startsWith(s.path)&&(r.setHeader("X-RateLimit-Limit",s.times),r.setHeader("X-RateLimit-Remaining",s.times-((Y=await l.functions.get(v+s.path))!=null?Y:0)),r.setHeader("X-RateLimit-Reset-Every",s.timeout),await l.functions.set(v+s.path,((Z=await l.functions.get(v+s.path))!=null?Z:0)+1),setTimeout(async()=>{var n;await l.functions.set(v+s.path,((n=await l.functions.get(v+s.path))!=null?n:0)-1)},s.timeout),await l.functions.get(v+s.path)>s.times))return r.statusCode=429,x=!0,o.print((_=l.message)!=null?_:"Rate Limited"),r.end()}if(E&&!x)if(!O)Promise.resolve(e[i].code(o)).catch(s=>{o.error=s,x=!0,b("error",o)}).then(()=>r.end());else{if(e[i].data.addTypes&&(e[i].path.endsWith(".pdf")&&o.setHeader("Content-Type","application/pdf"),e[i].path.endsWith(".js")&&o.setHeader("Content-Type","text/javascript"),e[i].path.endsWith(".html")&&o.setHeader("Content-Type","text/html"),e[i].path.endsWith(".css")&&o.setHeader("Content-Type","text/css"),e[i].path.endsWith(".csv")&&o.setHeader("Content-Type","text/csv"),e[i].path.endsWith(".mpeg")&&o.setHeader("Content-Type","video/mpeg"),e[i].path.endsWith(".mp4")&&o.setHeader("Content-Type","video/mp4"),e[i].path.endsWith(".webm")&&o.setHeader("Content-Type","video/webm"),e[i].path.endsWith(".bmp")&&o.setHeader("Content-Type","image/bmp")),!("content"in e[i].data)){let s=me.resolve(e[i].data.file),n,y=!1;try{n=M.readFileSync(s)}catch(p){y=!0,o.error=p,b("error",o)}return y?void 0:(r.write(n,"binary"),r.end())}return r.write(e[i].data.content,"binary"),r.end()}else b("notfound",o)}})});return T.listen(w,f),new Promise((u,r)=>{T.once("listening",()=>u({success:!0,port:w,message:"WEBSERVER STARTED",rawServer:T})),T.once("error",m=>r({success:!1,error:m,message:"WEBSERVER ERRORED"}))})}}});export default Se();
