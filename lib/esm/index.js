var Re=Object.create;var ne=Object.defineProperty;var Se=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var Ae=Object.getPrototypeOf,He=Object.prototype.hasOwnProperty;var ie=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,a)=>(typeof require<"u"?require:t)[a]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var U=(e,t)=>()=>(e&&(t=e(e=0)),t);var oe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var xe=(e,t,a,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let d of Ce(t))!He.call(e,d)&&d!==a&&ne(e,d,{get:()=>t[d],enumerable:!(c=Se(t,d))||c.enumerable});return e};var ce=(e,t,a)=>(a=e!=null?Re(Ae(e)):{},xe(t||!e||!e.__esModule?ne(a,"default",{value:e,enumerable:!0}):a,e));import*as I from"fs";var O,de,ue=U(()=>{O=(e,t)=>(t=t||[],I.readdirSync(e).forEach(c=>{if(I.statSync(e+"/"+c).isDirectory())t=O(e+"/"+c,t);else{let d=e+"/"+c;t.push(d)}}),t),de=(e,t,a)=>(a=a||[],a=O(e,a).filter(c=>c.endsWith(t)),a)});var $=oe((Pe,le)=>{le.exports=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});import*as D from"path";import*as fe from"fs";var W,S,k,he=U(()=>{ue();W=ce($()),S=e=>(e=e.replace(/\/{2,}/g,"/"),e.endsWith("/")&&e!=="/"?e.slice(0,-1):!e.startsWith("/")&&e!=="/"?`/${e}`:e),k=class{constructor(t,a){t=t!=null?t:[],a=a!=null?a:[],this.routes=t,this.events=a}event(t,a){return this.events.some(c=>c.event===t)?!1:this.events.push({event:t,code:a})-1}set(t,a,c){if(a=S(a),!W.default.includes(t))throw TypeError(`No Valid Request Type: ${t}
Possible Values: ${W.default.join(", ")}`);return this.routes.some(d=>d.method===t&&d.path===a)?!1:this.routes.push({method:t,path:a,pathArray:a.split("/"),code:c,data:{addTypes:!1}})-1}static(t,a,c){var L,P,E;t=S(t);let d=(L=c==null?void 0:c.preload)!=null?L:!1,f=(P=c==null?void 0:c.remHTML)!=null?P:!1,B=(E=c==null?void 0:c.addTypes)!=null?E:!0,y=[];for(let T of O(a)){let p=T.replace(a,"").replace("/",""),N=D+a.replace(p,"").replace(a,"").slice(0,-1);f&&p==="index.html"?p="":f&&p.endsWith(".html")?p.slice(0,-5):f&&p.endsWith(".htm")&&p.slice(0,-4);let C=S(`${N}/${p}`),A=this.routes.push({method:"STATIC",path:C,pathArray:C.split("/"),code:async()=>{},data:{addTypes:B,file:T}});d&&(this.routes[A-1].data.content=fe.readFileSync(T)),y.push(A-1)}return y}load(t){let a=de(t,".js"),c=[];for(let d of a){let f=ie(D.resolve(d));if(!(!("path"in f)||!("method"in f)||!("code"in f))){if(!W.default.includes(f.method))throw TypeError(`No Valid Request Type: ${f.method}
Possible Values: ${W.default.join(", ")}`);c.push(this.routes.push({method:f.method,path:S(f.path),pathArray:f.path.split("/"),code:f.code,data:{addTypes:!1}}))-1}}return c}list(){return{routes:this.routes,events:this.events}}}});var me,pe,ye=U(()=>{me=(y=>(y.options="OPTIONS",y.delete="DELETE",y.patch="PATCH",y.post="POST",y.put="PUT",y.get="GET",y.static="STATIC",y))(me||{}),pe=me});import*as Te from"path";import*as ge from"http";import*as be from"url";import*as V from"fs";var We=oe((Ue,ve)=>{he();ye();var we=ce($());ve.exports={routeList:k,types:pe,async start(e){var N,C,A,G,J,X,F,z,K,Q,Y;let t=(C=(N=e==null?void 0:e.routes)==null?void 0:N.list().routes)!=null?C:[],a=(G=(A=e==null?void 0:e.routes)==null?void 0:A.list().events)!=null?G:[],c=(J=e==null?void 0:e.proxy)!=null?J:!1,d=(X=e==null?void 0:e.rateLimits)!=null?X:{enabled:!1,list:[]},f=(F=e==null?void 0:e.bind)!=null?F:"0.0.0.0",B=(z=e==null?void 0:e.cors)!=null?z:!1,y=(K=e==null?void 0:e.port)!=null?K:2023,L=(Q=e==null?void 0:e.maxBody)!=null?Q:20,P=(Y=e==null?void 0:e.poweredBy)!=null?Y:!0,E=new Map,T=async(u,r)=>{switch(u){case"error":{let h=a.find(l=>l.event==="error");h?Promise.resolve(h.code(r)).catch(l=>{console.log(l),r.status(500),r.rawRes.write(`An Error occured in your Error Event (what the hell?)
`),r.rawRes.write(l.stack),r.rawRes.end()}).then(()=>r.rawRes.end()):(console.log(r.error),r.rawRes.write(`An Error occurred
`),r.rawRes.write(r.error.stack),r.status(500),r.rawRes.end())}case"request":{let h=!1,l=a.find(o=>o.event==="request");return l&&await Promise.resolve(l.code(r)).catch(o=>{h=!0,console.log(o),r.status(500),r.rawRes.write(`An Error occured in your Request Event
`),r.rawRes.write(o.stack),r.rawRes.end()}),h}case"notfound":{let h=!1,l=a.find(o=>o.event==="notfound");if(l)await Promise.resolve(l.code(r)).catch(o=>{h=!0,console.log(o),r.status(500),r.rawRes.write(`An Error occured in your NotFound Event
`),r.rawRes.write(o.stack),r.rawRes.end()}).then(()=>r.rawRes.end());else{let o="";for(let R of t){let v=R.method==="STATIC"?"GET":R.method;o+=`[-] [${v}] ${R.path}
`}r.status(404),r.rawRes.write(`[!] COULDNT FIND ${r.url.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${o}`),r.rawRes.end()}return h}}},p=ge.createServer(async(u,r)=>{let h="";if(u.headers["content-length"]&&Number(u.headers["content-length"])>=L*1e6)return r.statusCode=413,r.write("Payload Too Large"),r.end();u.on("data",l=>{h+=l}).on("end",async()=>{var q,ee,te;let l={...be.parse(u.url),method:u.method};l.path=S(l.path);let o;try{h=JSON.parse(h)}catch(s){}if(B&&(r.setHeader("Access-Control-Allow-Headers","*"),r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Request-Method","*"),r.setHeader("Access-Control-Allow-Methods",we.default.join(",")),u.method==="OPTIONS"))return r.end("");let R=new Map,v,j=!1,H=l.pathname.split("/");H[H.length-1]===""&&H.pop();for(let s=1;s<=t.length-1;s++){let n=t[s];if(n.path===l.pathname&&n.method===u.method){o=s,j=!1,v=!0;break}else if(n.path===l.pathname&&n.method==="STATIC"){o=s,j=!0,v=!0;break}if(n.method===u.method&&n.pathArray.length===H.length){if(v&&n.path!==t[o].path)break;for(let w=1;w<=n.pathArray.length-1;w++){let m=n.pathArray[w],b=H[w];if(!m.startsWith(":")&&b!==m)break;if(m!==b&&m.startsWith(":")){R.set(m.replace(":",""),decodeURIComponent(b)),o=s,v=!0;continue}}}}let g;c&&u.headers["x-forwarded-for"]?g=u.headers["x-forwarded-for"]:g=u.socket.remoteAddress;let M=new Map;Object.keys(u.headers).forEach(s=>{M.set(s,u.headers[s])}),M.delete("cookie");let Z=new Map;for(let[s,n]of new URLSearchParams(l.search))Z.set(s,n);let _=new Map;u.headers.cookie&&u.headers.cookie.split(";").forEach(s=>{let[n,...w]=s.split("=");if(n=n==null?void 0:n.trim(),!n)return;let m=w.join("=").trim();m&&_.set(n,decodeURIComponent(m))}),P&&r.setHeader("X-Powered-By","rjweb-server");let i={headers:M,cookies:_,params:R,queries:Z,client:{userAgent:u.headers["user-agent"],httpVersion:u.httpVersion,port:u.socket.remotePort,ip:g},body:h,url:l,rawServer:p,rawReq:u,rawRes:r,"@":{},setHeader(s,n){return r.setHeader(s,n),i},setCustom(s,n){return i["@"][s]=n,i},print(s,n){var m;let w=(m=n==null?void 0:n.niceJSON)!=null?m:!1;switch(typeof s){case"object":r.setHeader("Content-Type","application/json"),w?r.write(JSON.stringify(s,void 0,1)):r.write(JSON.stringify(s));break;case"bigint":case"number":case"boolean":r.write(s.toString());break;case"function":r.write(s());break;case"undefined":r.write("");break;default:try{r.write(s)}catch(b){i.error=b,x=!0,T("error",i)}}return i},status(s){return r.statusCode=s,i},printFile(s,n){var se,ae;let w=(se=n==null?void 0:n.addTypes)!=null?se:!0,m=(ae=n==null?void 0:n.cache)!=null?ae:!1;if(w&&(s.endsWith(".pdf")&&i.setHeader("Content-Type","application/pdf"),s.endsWith(".js")&&i.setHeader("Content-Type","text/javascript"),s.endsWith(".html")&&i.setHeader("Content-Type","text/html"),s.endsWith(".css")&&i.setHeader("Content-Type","text/css"),s.endsWith(".csv")&&i.setHeader("Content-Type","text/csv"),s.endsWith(".mpeg")&&i.setHeader("Content-Type","video/mpeg"),s.endsWith(".mp4")&&i.setHeader("Content-Type","video/mp4"),s.endsWith(".webm")&&i.setHeader("Content-Type","video/webm"),s.endsWith(".bmp")&&i.setHeader("Content-Type","image/bmp")),E.has(s))return r.write(E.get(s),"binary"),i;let b,re=!1;try{b=V.readFileSync(s)}catch(Ee){re=!0,i.error=Ee,T("error",i)}return re||(m&&E.set(s,b),r.write(b,"binary")),i}},x=await T("request",i);if(!x){if(d.enabled){for(let s of d.list)if(l.path.startsWith(s.path)&&(r.setHeader("X-RateLimit-Limit",s.times),r.setHeader("X-RateLimit-Remaining",s.times-((q=await d.functions.get(g+s.path))!=null?q:0)),r.setHeader("X-RateLimit-Reset-Every",s.timeout),await d.functions.set(g+s.path,((ee=await d.functions.get(g+s.path))!=null?ee:0)+1),setTimeout(async()=>{var n;await d.functions.set(g+s.path,((n=await d.functions.get(g+s.path))!=null?n:0)-1)},s.timeout),await d.functions.get(g+s.path)>s.times))return r.statusCode=429,x=!0,i.print((te=d.message)!=null?te:"Rate Limited"),r.end()}if(v&&!x)if(!j)Promise.resolve(t[o].code(i)).catch(s=>{i.error=s,x=!0,T("error",i)}).then(()=>r.end());else{if(t[o].data.addTypes&&(t[o].path.endsWith(".pdf")&&i.setHeader("Content-Type","application/pdf"),t[o].path.endsWith(".js")&&i.setHeader("Content-Type","text/javascript"),t[o].path.endsWith(".html")&&i.setHeader("Content-Type","text/html"),t[o].path.endsWith(".css")&&i.setHeader("Content-Type","text/css"),t[o].path.endsWith(".csv")&&i.setHeader("Content-Type","text/csv"),t[o].path.endsWith(".mpeg")&&i.setHeader("Content-Type","video/mpeg"),t[o].path.endsWith(".mp4")&&i.setHeader("Content-Type","video/mp4"),t[o].path.endsWith(".webm")&&i.setHeader("Content-Type","video/webm"),t[o].path.endsWith(".bmp")&&i.setHeader("Content-Type","image/bmp")),!("content"in t[o].data)){let s=Te.resolve(t[o].data.file),n,w=!1;try{n=V.readFileSync(s)}catch(m){w=!0,i.error=m,T("error",i)}return w?void 0:(r.write(n,"binary"),r.end())}return r.write(t[o].data.content,"binary"),r.end()}else T("notfound",i)}})});return p.listen(y,f),new Promise((u,r)=>{p.once("listening",()=>u({success:!0,port:y,message:"WEBSERVER STARTED",rawServer:p})),p.once("error",h=>r({success:!1,error:h,message:"WEBSERVER ERRORED"}))})}}});export default We();
