var he=Object.create;var Y=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var we=Object.getPrototypeOf,be=Object.prototype.hasOwnProperty;var Z=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(a,o)=>(typeof require<"u"?require:a)[o]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var O=(r,a)=>()=>(r&&(a=r(r=0)),a);var _=(r,a)=>()=>(a||r((a={exports:{}}).exports,a),a.exports);var Te=(r,a,o,n)=>{if(a&&typeof a=="object"||typeof a=="function")for(let l of ge(a))!be.call(r,l)&&l!==o&&Y(r,l,{get:()=>a[l],enumerable:!(n=ye(a,l))||n.enumerable});return r};var ee=(r,a,o)=>(o=r!=null?he(we(r)):{},Te(a||!r||!r.__esModule?Y(o,"default",{value:r,enumerable:!0}):o,r));import*as L from"fs";var x,te,re=O(()=>{x=(r,a)=>(a=a||[],L.readdirSync(r).forEach(n=>{if(L.statSync(r+"/"+n).isDirectory())a=x(r+"/"+n,a);else{let l=r+"/"+n;a.push(l)}}),a),te=(r,a,o)=>(o=o||[],o=x(r,o).filter(n=>n.endsWith(a)),o)});var U=_((Pe,ae)=>{ae.exports=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});import*as ne from"path";import*as se from"fs";var R,k,ie=O(()=>{re();R=ee(U()),k=class{constructor(a){a=a!=null?a:[],this.urls=a}set(a,o,n){if(!R.default.includes(a))throw TypeError(`No Valid Request Type: ${a}
Possible Values: ${R.default.join(", ")}`);this.urls[a+o]={array:o.split("/"),addTypes:!1,path:o,type:a,code:n}}static(a,o,n){var p,S,H;let l=(p=n==null?void 0:n.preload)!=null?p:!1,m=(S=n==null?void 0:n.remHTML)!=null?S:!1,W=(H=n==null?void 0:n.addTypes)!=null?H:!0;for(let h of x(o)){let T=h.replace(o,""),y="";T.replace("/","")==="index.html"&&m?y=a.replace("//","/"):T.replace("/","").endsWith(".html")&&m?y=(a+T).replace("//","/").replace(".html",""):y=(a+T).replace("//","/"),this.urls["GET"+y]={file:h,array:y.split("/"),addTypes:W,path:y,type:"STATIC"},l&&(this.urls["GET"+y].content=se.readFileSync(h))}}load(a){let o=te(a,".js");for(let n of o){let l=Z(ne.resolve(n));if(!(!("path"in l)||!("type"in l)||!("code"in l))){if(!R.default.includes(l.type))throw TypeError(`No Valid Request Type: ${l.type}
Possible Values: ${R.default.toString()}`);this.urls[l.type+l.path]={array:l.path.split("/"),addTypes:!1,path:l.path,type:l.type,code:l.code}}}}list(){return this.urls}}});var oe,ce,le=O(()=>{oe=(p=>(p.options="OPTIONS",p.delete="DELETE",p.patch="PATCH",p.post="POST",p.put="PUT",p.get="GET",p.static="STATIC",p))(oe||{}),ce=oe});import*as ue from"path";import*as fe from"http";import*as me from"url";import*as j from"fs";var Ee=_((xe,pe)=>{ie();le();var de=ee(U());pe.exports={routeList:k,types:ce,async start(r){var T,y,M,D,$,G,V,B,F;let a=(T=r==null?void 0:r.pages)!=null?T:{},o=(y=r==null?void 0:r.events)!=null?y:{},n=(M=r==null?void 0:r.urls.list())!=null?M:[],l=(D=r==null?void 0:r.proxy)!=null?D:!1,m=($=r==null?void 0:r.rateLimits)!=null?$:{enabled:!1,list:[]},W=(G=r==null?void 0:r.bind)!=null?G:"0.0.0.0",p=(V=r==null?void 0:r.cors)!=null?V:!1,S=(B=r==null?void 0:r.port)!=null?B:5002,H=(F=r==null?void 0:r.body)!=null?F:20,h=fe.createServer(async(c,e)=>{let E="";if(c.headers["content-length"]&&parseInt(c.headers["content-length"])>=H*1e6)return e.statusCode=413,e.write("Payload Too Large"),e.end();c.on("data",u=>{E+=u}).on("end",async()=>{var z,K,Q;let u={...me.parse(c.url),method:c.method};u.path.endsWith("/")&&(u.path=u.path.slice(0,-1));let d="";try{E=JSON.parse(E)}catch(t){}if(p&&(e.setHeader("Access-Control-Allow-Headers","*"),e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Request-Method","*"),e.setHeader("Access-Control-Allow-Methods",de.default.join(",")),c.method==="OPTIONS"))return e.end("");let J=new Map,P,I=!1,v=u.pathname.split("/");v[v.length-1]===""&&v.pop();for(let t in n){if(t in n&&t.replace(c.method,"")===u.pathname&&n[t].type===c.method){d=c.method+u.pathname,I=!1,P=!0;break}if(t in n&&t.replace(c.method,"")===u.pathname&&n[t].type==="STATIC"){d=c.method+u.pathname,I=!0,P=!0;break}let s=n[t];if(s.type!==c.method||s.array.length!==v.length)continue;if(P&&s.array.join("/")!==d)break;let f=0;for(let w of s.array){let b=s.array[f],C=v[f];if(f++,!b.startsWith(":")&&C!==b)break;if(b!==C&&b.startsWith(":")){J.set(b.replace(":",""),decodeURIComponent(C)),d=c.method+s.array.join("/"),P=!0;continue}}}let g;l&&c.headers["x-forwarded-for"]?g=c.headers["x-forwarded-for"]:g=c.socket.remoteAddress;let N=new Map;Object.keys(c.headers).forEach(t=>{N.set(t,c.headers[t])}),N.delete("cookie");let X=new Map;for(let[t,s]of new URLSearchParams(u.search))X.set(t,s);let q=new Map;c.headers.cookie&&c.headers.cookie.split(";").forEach(t=>{let[s,...f]=t.split("=");if(s=s==null?void 0:s.trim(),!s)return;let w=f.join("=").trim();w&&q.set(s,decodeURIComponent(w))}),e.setHeader("X-Powered-By","rjweb-server");let i={header:N,cookie:q,param:J,query:X,hostPort:c.socket.remotePort,hostIp:g,reqBody:E,reqUrl:u,rawServer:h,rawReq:c,rawRes:e,"@":{},setHeader(t,s){return e.setHeader(t,s),i},setCustom(t,s){return i["@"][t]=s,i},print(t,s){var w;let f=(w=s==null?void 0:s.niceJSON)!=null?w:!1;switch(typeof t){case"object":e.setHeader("Content-Type","application/json"),f?e.write(JSON.stringify(t,void 0,1)):e.write(JSON.stringify(t));break;case"bigint":case"number":case"boolean":e.write(t.toString());break;case"function":e.write(t());break;case"undefined":e.write("");break;default:try{e.write(t)}catch(b){"reqError"in a?(i.error=b,Promise.resolve(a.reqError(i)).catch(C=>{console.log(C),e.statusCode=500,e.write(C),e.end()}).then(()=>e.end()),A=!0):(A=!0,console.log(b),e.statusCode=500,e.end())}}return i},status(t){return e.statusCode=t,i},printFile(t){let s=j.readFileSync(t);return e.write(s,"binary"),i}},A=!1;if("request"in o&&await o.request(i).catch(t=>{if("reqError"in a)i.error=t,Promise.resolve(a.reqError(i)).catch(s=>{console.log(s),e.statusCode=500,e.write(s),e.end()}).then(()=>e.end()),A=!0;else return A=!0,console.log(t),e.statusCode=500,e.end()}),!A){if(m.enabled){for(let t of m.list)if(u.path.startsWith(t.path)&&(e.setHeader("X-RateLimit-Limit",t.times),e.setHeader("X-RateLimit-Remaining",t.times-((z=await m.functions.get(g+t.path))!=null?z:0)),e.setHeader("X-RateLimit-Reset-Every",t.timeout),await m.functions.set(g+t.path,((K=await m.functions.get(g+t.path))!=null?K:0)+1),setTimeout(async()=>{var s;await m.functions.set(g+t.path,((s=await m.functions.get(g+t.path))!=null?s:0)-1)},t.timeout),await m.functions.get(g+t.path)>t.times))return e.statusCode=429,i.print((Q=m.message)!=null?Q:"Rate Limited"),e.end()}if(P)if(!I)Promise.resolve(n[d].code(i)).catch(t=>{"reqError"in a?(i.error=t,Promise.resolve(a.reqError(i)).catch(s=>{console.log(s),e.statusCode=500,e.write(s),e.end()}).then(()=>e.end())):(console.log(t),e.statusCode=500,e.write(t),e.end())}).then(()=>e.end());else{if(n[d].addTypes&&(n[d].path.endsWith(".pdf")&&i.setHeader("Content-Type","application/pdf"),n[d].path.endsWith(".js")&&i.setHeader("Content-Type","text/javascript"),n[d].path.endsWith(".html")&&i.setHeader("Content-Type","text/html"),n[d].path.endsWith(".css")&&i.setHeader("Content-Type","text/css"),n[d].path.endsWith(".csv")&&i.setHeader("Content-Type","text/csv"),n[d].path.endsWith(".mpeg")&&i.setHeader("Content-Type","video/mpeg"),n[d].path.endsWith(".mp4")&&i.setHeader("Content-Type","video/mp4"),n[d].path.endsWith(".webm")&&i.setHeader("Content-Type","video/webm"),n[d].path.endsWith(".bmp")&&i.setHeader("Content-Type","image/bmp")),!("content"in n[d])){let t,s=ue.resolve(n[d].file);try{t=j.readFileSync(s)}catch(f){return console.log(f),e.end()}return e.write(t,"binary"),e.end()}return e.write(n[d].content,"binary"),e.end()}else if("notFound"in a)Promise.resolve(a.notFound(i)).catch(t=>{"reqError"in a?(i.error=t,a.reqError(i).catch(s=>{console.log(s),e.statusCode=500,e.write(s),e.end()}).then(()=>e.end())):(console.log(t),e.statusCode=500,e.write(t),e.end())}).then(()=>e.end());else{let t="";for(let s in n){let f=n[s],w=f.type==="STATIC"?"GET":f.type;t+=`[-] [${w}] ${f.path}
`}e.statusCode=404,e.write(`[!] COULDNT FIND ${u.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${t}`),e.end()}}})});return h.on("upgrade",(c,e,E)=>{e.write(`HTTP/1.1 101 Web Socket Protocol Handshake\r
Upgrade: WebSocket\r
Connection: Upgrade\r
\r
`),e.pipe(e)}),h.listen(S,W),new Promise((c,e)=>{h.once("listening",()=>c({success:!0,port:S,message:"WEBSERVER STARTED",rawServer:h})),h.once("error",E=>e({success:!1,error:E,message:"WEBSERVER ERRORED"}))})}}});export default Ee();
