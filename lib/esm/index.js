var ie=Object.create;var V=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var ue=Object.getOwnPropertyNames;var de=Object.getPrototypeOf,fe=Object.prototype.hasOwnProperty;var G=(s=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(s,{get:(n,i)=>(typeof require<"u"?require:n)[i]}):s)(function(s){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+s+'" is not supported')});var L=(s,n)=>()=>(s&&(n=s(s=0)),n);var J=(s,n)=>()=>(n||s((n={exports:{}}).exports,n),n.exports);var me=(s,n,i,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let f of ue(n))!fe.call(s,f)&&f!==i&&V(s,f,{get:()=>n[f],enumerable:!(c=ce(n,f))||c.enumerable});return s};var X=(s,n,i)=>(i=s!=null?ie(de(s)):{},me(n||!s||!s.__esModule?V(i,"default",{value:s,enumerable:!0}):i,s));import*as W from"fs";var H,z,F=L(()=>{H=(s,n)=>(n=n||[],W.readdirSync(s).forEach(c=>{if(W.statSync(s+"/"+c).isDirectory())n=H(s+"/"+c,n);else{let f=s+"/"+c;n.push(f)}}),n),z=(s,n,i)=>(i=i||[],i=H(s,i).filter(c=>c.endsWith(n)),i)});var B=J((we,K)=>{K.exports=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});import*as Q from"path";import*as Y from"fs";var E,v,T,P=L(()=>{F();E=X(B()),v=s=>(s=s.replace(/\/{2,}/g,"/"),s.endsWith("/")&&s!=="/"?s.slice(0,-1):!s.startsWith("/")&&s!=="/"?`/${s}`:s),T=class{constructor(n,i){n=n!=null?n:[],i=i!=null?i:[],this.routes=n,this.events=i}event(n,i){return this.events.some(c=>c.event===n)?!1:this.events.push({event:n,code:i})-1}set(n,i,c){if(i=v(i),!E.default.includes(n))throw TypeError(`No Valid Request Type: ${n}
Possible Values: ${E.default.join(", ")}`);return this.routes.some(f=>f.method===n&&f.path===i)?!1:this.routes.push({method:n,path:i,pathArray:i.split("/"),code:c,data:{addTypes:!1}})-1}static(n,i,c){var p,u,t;n=v(n);let f=(p=c==null?void 0:c.preload)!=null?p:!1,m=(u=c==null?void 0:c.remHTML)!=null?u:!1,d=(t=c==null?void 0:c.addTypes)!=null?t:!0,r=[];for(let x of H(i)){let y=x.replace(i,"").replace("/","").replace("\\","/"),g=n+i.replace(y,"").replace(i,"").slice(0,-1);m&&y==="index.html"?y="":m&&y.endsWith(".html")?y.slice(0,-5):m&&y.endsWith(".htm")&&y.slice(0,-4);let b=v(`${g}/${y}`),R=this.routes.push({method:"STATIC",path:b,pathArray:b.split("/"),code:async()=>{},data:{addTypes:d,file:x}});f&&(this.routes[R-1].data.content=Y.readFileSync(x)),r.push(R-1)}return r}load(n){let i=z(n,".js"),c=[];for(let f of i){let m=G(Q.resolve(f));if(!(!("path"in m)||!("method"in m)||!("code"in m))){if(!E.default.includes(m.method))throw TypeError(`No Valid Request Type: ${m.method}
Possible Values: ${E.default.join(", ")}`);c.push(this.routes.push({method:m.method,path:v(m.path),pathArray:v(m.path).split("/"),code:m.code,data:{addTypes:!1}})-1)}}return c}list(){return{routes:this.routes,events:this.events}}}});var C,Z=L(()=>{P();C=class{constructor(n){this.data={routes:new T,rateLimits:{enabled:!1,message:"Rate Limited",list:[],functions:new Map},bind:"0.0.0.0",proxy:!1,cors:!1,port:2023,maxBody:5,poweredBy:!0,...n}}getOptions(){return this.data}}});var _,q,ee=L(()=>{_=(r=>(r.options="OPTIONS",r.delete="DELETE",r.patch="PATCH",r.post="POST",r.put="PUT",r.get="GET",r.static="STATIC",r))(_||{}),q=_});import{EventEmitter as pe}from"stream";import*as re from"path";import*as se from"http";import*as ne from"url";import*as I from"fs";var le=J((We,ae)=>{P();Z();ee();var te=X(B());ae.exports={routeList:T,types:q,async start(s){s=new C(s).getOptions();let{routes:n,events:i}=s.routes.list(),c=new Map,f=async(d,r)=>{switch(d){case"error":{let p=i.find(u=>u.event==="error");p?Promise.resolve(p.code(r)).catch(u=>{console.log(u),r.status(500),r.rawRes.write(`An Error occured in your Error Event (what the hell?)
`),r.rawRes.write(u.stack),r.rawRes.end()}).then(()=>r.rawRes.end()):(console.log(r.error),r.rawRes.write(`An Error occurred
`),r.rawRes.write(r.error.stack),r.status(500),r.rawRes.end())}case"request":{let p=!1,u=i.find(t=>t.event==="request");return u&&await Promise.resolve(u.code(r)).catch(t=>{p=!0,console.log(t),r.status(500),r.rawRes.write(`An Error occured in your Request Event
`),r.rawRes.write(t.stack),r.rawRes.end()}),p}case"notfound":{let p=!1,u=i.find(t=>t.event==="notfound");if(u)await Promise.resolve(u.code(r)).catch(t=>{p=!0,console.log(t),r.status(500),r.rawRes.write(`An Error occured in your NotFound Event
`),r.rawRes.write(t.stack),r.rawRes.end()}).then(()=>r.rawRes.end());else{let t="";for(let x of n){let y=x.method==="STATIC"?"GET":x.method;t+=`[-] [${y}] ${x.path}
`}r.status(404),r.rawRes.write(`[!] COULDNT FIND ${r.url.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${t}`),r.rawRes.end()}return p}}},m=se.createServer(async(d,r)=>{let p="";if(d.headers["content-length"]&&Number(d.headers["content-length"])>=s.maxBody*1e6)return r.statusCode=413,r.write("Payload Too Large"),r.end();d.on("data",u=>{p+=u}).on("end",async()=>{var O,M,j;let u={...ne.parse(d.url),method:d.method};u.path=v(u.path),u.pathname=v(u.pathname);try{p=JSON.parse(p)}catch(e){}if(s.cors&&(r.setHeader("Access-Control-Allow-Headers","*"),r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Request-Method","*"),r.setHeader("Access-Control-Allow-Methods",te.default.join(",")),d.method==="OPTIONS"))return r.end("");let t={content:Buffer.from(""),events:new pe,waiting:!1,execute:{route:null,static:!1,exists:!1}};t.events.on("noWaiting",()=>t.waiting=!1),r.once("close",()=>t.events.emit("endRequest"));let x=new Map,y=u.pathname.split("/");for(let e=0;e<=n.length-1;e++){let o=n[e];if(o.path===u.pathname&&o.method===d.method){t.execute.route=n[e],t.execute.static=!1,t.execute.exists=!0;break}if(o.path===u.pathname&&o.method==="STATIC"){t.execute.route=n[e],t.execute.static=!0,t.execute.exists=!0;break}if(o.method===d.method&&o.pathArray.length===y.length){if(t.execute.exists)break;for(let h=0;h<=o.pathArray.length-1;h++){let l=o.pathArray[h],w=y[h];if(!l.startsWith(":")&&w!==l)break;if(l!==w&&l.startsWith(":")){x.set(l.replace(":",""),decodeURIComponent(w)),t.execute.route=n[e],t.execute.exists=!0;continue}}}}let g;s.proxy&&d.headers["x-forwarded-for"]?g=d.headers["x-forwarded-for"]:g=d.socket.remoteAddress;let b=new Map;Object.keys(d.headers).forEach(e=>{b.set(e,d.headers[e])}),b.delete("cookie");let R=new Map;for(let[e,o]of new URLSearchParams(u.search))R.set(e,decodeURIComponent(o));let N=new Map;d.headers.cookie&&d.headers.cookie.split(";").forEach(e=>{let[o,...h]=e.split("=");if(o=o==null?void 0:o.trim(),!o)return;let l=h.join("=").trim();l&&N.set(o,decodeURIComponent(l))}),s.poweredBy&&r.setHeader("X-Powered-By","rjweb-server");let a={headers:b,cookies:N,params:x,queries:R,client:{userAgent:d.headers["user-agent"],httpVersion:d.httpVersion,port:d.socket.remotePort,ip:g},body:p,url:u,rawServer:m,rawReq:d,rawRes:r,"@":{},setHeader(e,o){return r.setHeader(e,o),a},setCustom(e,o){return a["@"][e]=o,a},print(e,o){var l;let h=(l=o==null?void 0:o.niceJSON)!=null?l:!1;switch(typeof e){case"object":r.setHeader("Content-Type","application/json"),h?t.content=Buffer.from(JSON.stringify(e,void 0,1)):t.content=Buffer.from(JSON.stringify(e));break;case"string":t.content=Buffer.from(e);break;case"symbol":t.content=Buffer.from(e.toString());break;case"bigint":case"number":case"boolean":t.content=Buffer.from(String(e));break;case"function":t.waiting=!0,(async()=>{let w=await e();if(typeof w!="function")a.print(w,{niceJSON:h});else return a.error=new Error("Cant return functions from functions, consider using async/await"),f("error",a);let A=t.content;t.content=A,t.events.emit("noWaiting")})();break;case"undefined":t.content=Buffer.from("");break}return a},status(e){return r.statusCode=e,a},printFile(e,o){var U,$;let h=(U=o==null?void 0:o.addTypes)!=null?U:!0,l=($=o==null?void 0:o.cache)!=null?$:!1;if(h&&(e.endsWith(".pdf")&&a.setHeader("Content-Type","application/pdf"),e.endsWith(".js")&&a.setHeader("Content-Type","text/javascript"),e.endsWith(".html")&&a.setHeader("Content-Type","text/html"),e.endsWith(".css")&&a.setHeader("Content-Type","text/css"),e.endsWith(".csv")&&a.setHeader("Content-Type","text/csv"),e.endsWith(".mpeg")&&a.setHeader("Content-Type","video/mpeg"),e.endsWith(".mp4")&&a.setHeader("Content-Type","video/mp4"),e.endsWith(".webm")&&a.setHeader("Content-Type","video/webm"),e.endsWith(".bmp")&&a.setHeader("Content-Type","image/bmp")),c.has(e))return t.content=c.get(e),a;let w,A=!1;try{w=I.createReadStream(e),t.waiting=!0,w.pipe(r)}catch(k){A=!0,a.error=k,f("error",a)}return A||(w.on("data",k=>{var D;let oe=(D=c.get(e))!=null?D:Buffer.from("");l&&c.set(e,Buffer.concat([oe,k]))}),w.once("end",()=>t.events.emit("noWaiting")),r.once("close",()=>w.close())),a}},S=await f("request",a);if(!S){if(s.rateLimits.enabled){for(let e of s.rateLimits.list)if(u.path.startsWith(e.path)&&(r.setHeader("X-RateLimit-Limit",e.times),r.setHeader("X-RateLimit-Remaining",e.times-((O=await s.rateLimits.functions.get(g+e.path))!=null?O:0)),r.setHeader("X-RateLimit-Reset-Every",e.timeout),await s.rateLimits.functions.set(g+e.path,((M=await s.rateLimits.functions.get(g+e.path))!=null?M:0)+1),setTimeout(async()=>{var o;await s.rateLimits.functions.set(g+e.path,((o=await s.rateLimits.functions.get(g+e.path))!=null?o:0)-1)},e.timeout),await s.rateLimits.functions.get(g+e.path)>e.times))return r.statusCode=429,S=!0,a.print((j=s.rateLimits.message)!=null?j:"Rate Limited"),r.end()}if(!await new Promise(e=>{if(!t.waiting)return e(!1);t.events.once("noWaiting",()=>e(!1)),t.events.once("endRequest",()=>e(!0))}))if(t.execute.exists&&!S){if(!t.execute.static)await Promise.resolve(t.execute.route.code(a)).catch(e=>{a.error=e,S=!0,f("error",a)});else{if(t.execute.route.data.addTypes&&(t.execute.route.path.endsWith(".pdf")&&a.setHeader("Content-Type","application/pdf"),t.execute.route.path.endsWith(".js")&&a.setHeader("Content-Type","text/javascript"),t.execute.route.path.endsWith(".html")&&a.setHeader("Content-Type","text/html"),t.execute.route.path.endsWith(".css")&&a.setHeader("Content-Type","text/css"),t.execute.route.path.endsWith(".csv")&&a.setHeader("Content-Type","text/csv"),t.execute.route.path.endsWith(".mpeg")&&a.setHeader("Content-Type","video/mpeg"),t.execute.route.path.endsWith(".mp4")&&a.setHeader("Content-Type","video/mp4"),t.execute.route.path.endsWith(".webm")&&a.setHeader("Content-Type","video/webm"),t.execute.route.path.endsWith(".bmp")&&a.setHeader("Content-Type","image/bmp")),!("content"in t.execute.route.data)){let e=re.resolve(t.execute.route.data.file),o,h=!1;try{o=I.createReadStream(e),t.waiting=!0,o.pipe(r)}catch(l){h=!0,a.error=l,f("error",a)}if(h)return a;o.once("end",()=>t.events.emit("noWaiting")),r.once("close",()=>o.close())}t.content=t.execute.route.data.content}await new Promise(e=>{if(!t.waiting)return e(!0);t.events.once("noWaiting",()=>e(!1))}),r.end(t.content,"binary")}else f("notfound",a)}})});return m.listen(s.port,s.bind),new Promise((d,r)=>{m.once("listening",()=>d({success:!0,port:s.port,message:"WEBSERVER STARTED",rawServer:m})),m.once("error",p=>{m.close(),r({success:!1,error:p,message:"WEBSERVER ERRORED"})})})}}});export default le();
