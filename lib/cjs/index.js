var ye=Object.create;var ae=Object.defineProperty;var we=Object.getOwnPropertyDescriptor;var Te=Object.getOwnPropertyNames;var ge=Object.getPrototypeOf,be=Object.prototype.hasOwnProperty;var ve=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Ee=(r,t,i,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let d of Te(t))!be.call(r,d)&&d!==i&&ae(r,d,{get:()=>t[d],enumerable:!(c=we(t,d))||c.enumerable});return r};var v=(r,t,i)=>(i=r!=null?ye(ge(r)):{},Ee(t||!r||!r.__esModule?ae(i,"default",{value:r,enumerable:!0}):i,r));var U=ve((Ce,ie)=>{ie.exports=["OPTIONS","DELETE","PATCH","STATIC","POST","PUT","GET"]});var I=v(require("fs")),O=(r,t)=>(t=t||[],I.readdirSync(r).forEach(c=>{if(I.statSync(r+"/"+c).isDirectory())t=O(r+"/"+c,t);else{let d=r+"/"+c;t.push(d)}}),t),ne=(r,t,i)=>(i=i||[],i=O(r,i).filter(c=>c.endsWith(t)),i);var W=v(U()),oe=v(require("path")),ce=v(require("fs")),E=r=>(r=r.replace(/\/{2,}/g,"/"),r.endsWith("/")&&r!=="/"?r.slice(0,-1):!r.startsWith("/")&&r!=="/"?`/${r}`:r),k=class{constructor(t,i){t=t!=null?t:[],i=i!=null?i:[],this.routes=t,this.events=i}event(t,i){return this.events.some(c=>c.event===t)?!1:this.events.push({event:t,code:i})-1}set(t,i,c){if(i=E(i),!W.default.includes(t))throw TypeError(`No Valid Request Type: ${t}
Possible Values: ${W.default.join(", ")}`);return this.routes.some(d=>d.method===t&&d.path===i)?!1:this.routes.push({method:t,path:i,pathArray:i.split("/"),code:c,data:{addTypes:!1}})-1}static(t,i,c){var L,N,S;t=E(t);let d=(L=c==null?void 0:c.preload)!=null?L:!1,f=(N=c==null?void 0:c.remHTML)!=null?N:!1,B=(S=c==null?void 0:c.addTypes)!=null?S:!0,y=[];for(let T of O(i)){let h=T.replace(i,"").replace("/","").replace("\\","/"),P=t+i.replace(h,"").replace(i,"").slice(0,-1);f&&h==="index.html"?h="":f&&h.endsWith(".html")?h.slice(0,-5):f&&h.endsWith(".htm")&&h.slice(0,-4);let A=E(`${P}/${h}`),H=this.routes.push({method:"STATIC",path:A,pathArray:A.split("/"),code:async()=>{},data:{addTypes:B,file:T}});d&&(this.routes[H-1].data.content=ce.readFileSync(T)),y.push(H-1)}return y}load(t){let i=ne(t,".js"),c=[];for(let d of i){let f=require(oe.resolve(d));if(!(!("path"in f)||!("method"in f)||!("code"in f))){if(!W.default.includes(f.method))throw TypeError(`No Valid Request Type: ${f.method}
Possible Values: ${W.default.join(", ")}`);c.push(this.routes.push({method:f.method,path:E(f.path),pathArray:E(f.path).split("/"),code:f.code,data:{addTypes:!1}})-1)}}return c}list(){return{routes:this.routes,events:this.events}}};var de=(y=>(y.options="OPTIONS",y.delete="DELETE",y.patch="PATCH",y.post="POST",y.put="PUT",y.get="GET",y.static="STATIC",y))(de||{}),le=de;var ue=v(U()),fe=v(require("path")),he=v(require("http")),me=v(require("url")),$=v(require("fs"));module.exports={routeList:k,types:le,async start(r){var P,A,H,D,V,G,J,X,F,z,K;let t=(A=(P=r==null?void 0:r.routes)==null?void 0:P.list().routes)!=null?A:[],i=(D=(H=r==null?void 0:r.routes)==null?void 0:H.list().events)!=null?D:[],c=(V=r==null?void 0:r.proxy)!=null?V:!1,d=(G=r==null?void 0:r.rateLimits)!=null?G:{enabled:!1,list:[]},f=(J=r==null?void 0:r.bind)!=null?J:"0.0.0.0",B=(X=r==null?void 0:r.cors)!=null?X:!1,y=(F=r==null?void 0:r.port)!=null?F:2023,L=(z=r==null?void 0:r.maxBody)!=null?z:20,N=(K=r==null?void 0:r.poweredBy)!=null?K:!0,S=new Map,T=async(u,e)=>{switch(u){case"error":{let m=i.find(l=>l.event==="error");m?Promise.resolve(m.code(e)).catch(l=>{console.log(l),e.status(500),e.rawRes.write(`An Error occured in your Error Event (what the hell?)
`),e.rawRes.write(l.stack),e.rawRes.end()}).then(()=>e.rawRes.end()):(console.log(e.error),e.rawRes.write(`An Error occurred
`),e.rawRes.write(e.error.stack),e.status(500),e.rawRes.end())}case"request":{let m=!1,l=i.find(o=>o.event==="request");return l&&await Promise.resolve(l.code(e)).catch(o=>{m=!0,console.log(o),e.status(500),e.rawRes.write(`An Error occured in your Request Event
`),e.rawRes.write(o.stack),e.rawRes.end()}),m}case"notfound":{let m=!1,l=i.find(o=>o.event==="notfound");if(l)await Promise.resolve(l.code(e)).catch(o=>{m=!0,console.log(o),e.status(500),e.rawRes.write(`An Error occured in your NotFound Event
`),e.rawRes.write(o.stack),e.rawRes.end()}).then(()=>e.rawRes.end());else{let o="";for(let C of t){let R=C.method==="STATIC"?"GET":C.method;o+=`[-] [${R}] ${C.path}
`}e.status(404),e.rawRes.write(`[!] COULDNT FIND ${e.url.pathname.toUpperCase()}
[i] AVAILABLE PAGES:

${o}`),e.rawRes.end()}return m}}},h=he.createServer(async(u,e)=>{let m="";if(u.headers["content-length"]&&Number(u.headers["content-length"])>=L*1e6)return e.statusCode=413,e.write("Payload Too Large"),e.end();u.on("data",l=>{m+=l}).on("end",async()=>{var _,q,ee;let l={...me.parse(u.url),method:u.method};l.path=E(l.path),l.pathname=E(l.pathname);let o;try{m=JSON.parse(m)}catch(s){}if(B&&(e.setHeader("Access-Control-Allow-Headers","*"),e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Request-Method","*"),e.setHeader("Access-Control-Allow-Methods",ue.default.join(",")),u.method==="OPTIONS"))return e.end("");let C=new Map,R,j=!1,Q=l.pathname.split("/");for(let s=0;s<=t.length-1;s++){let n=t[s];if(n.path===l.pathname&&n.method===u.method){o=s,j=!1,R=!0;break}if(n.path===l.pathname&&n.method==="STATIC"){o=s,j=!0,R=!0;break}if(n.method===u.method&&n.pathArray.length===Q.length){if(R)break;for(let w=0;w<=n.pathArray.length-1;w++){let p=n.pathArray[w],b=Q[w];if(!p.startsWith(":")&&b!==p)break;if(p!==b&&p.startsWith(":")){C.set(p.replace(":",""),decodeURIComponent(b)),o=s,R=!0;continue}}}}let g;c&&u.headers["x-forwarded-for"]?g=u.headers["x-forwarded-for"]:g=u.socket.remoteAddress;let M=new Map;Object.keys(u.headers).forEach(s=>{M.set(s,u.headers[s])}),M.delete("cookie");let Y=new Map;for(let[s,n]of new URLSearchParams(l.search))Y.set(s,n);let Z=new Map;u.headers.cookie&&u.headers.cookie.split(";").forEach(s=>{let[n,...w]=s.split("=");if(n=n==null?void 0:n.trim(),!n)return;let p=w.join("=").trim();p&&Z.set(n,decodeURIComponent(p))}),N&&e.setHeader("X-Powered-By","rjweb-server");let a={headers:M,cookies:Z,params:C,queries:Y,client:{userAgent:u.headers["user-agent"],httpVersion:u.httpVersion,port:u.socket.remotePort,ip:g},body:m,url:l,rawServer:h,rawReq:u,rawRes:e,"@":{},setHeader(s,n){return e.setHeader(s,n),a},setCustom(s,n){return a["@"][s]=n,a},print(s,n){var p;let w=(p=n==null?void 0:n.niceJSON)!=null?p:!1;switch(typeof s){case"object":e.setHeader("Content-Type","application/json"),w?e.write(JSON.stringify(s,void 0,1)):e.write(JSON.stringify(s));break;case"bigint":case"number":case"boolean":e.write(s.toString());break;case"function":e.write(s());break;case"undefined":e.write("");break;default:try{e.write(s)}catch(b){a.error=b,x=!0,T("error",a)}}return a},status(s){return e.statusCode=s,a},printFile(s,n){var re,se;let w=(re=n==null?void 0:n.addTypes)!=null?re:!0,p=(se=n==null?void 0:n.cache)!=null?se:!1;if(w&&(s.endsWith(".pdf")&&a.setHeader("Content-Type","application/pdf"),s.endsWith(".js")&&a.setHeader("Content-Type","text/javascript"),s.endsWith(".html")&&a.setHeader("Content-Type","text/html"),s.endsWith(".css")&&a.setHeader("Content-Type","text/css"),s.endsWith(".csv")&&a.setHeader("Content-Type","text/csv"),s.endsWith(".mpeg")&&a.setHeader("Content-Type","video/mpeg"),s.endsWith(".mp4")&&a.setHeader("Content-Type","video/mp4"),s.endsWith(".webm")&&a.setHeader("Content-Type","video/webm"),s.endsWith(".bmp")&&a.setHeader("Content-Type","image/bmp")),S.has(s))return e.write(S.get(s),"binary"),a;let b,te=!1;try{b=$.readFileSync(s)}catch(pe){te=!0,a.error=pe,T("error",a)}return te||(p&&S.set(s,b),e.write(b,"binary")),a}},x=await T("request",a);if(!x){if(d.enabled){for(let s of d.list)if(l.path.startsWith(s.path)&&(e.setHeader("X-RateLimit-Limit",s.times),e.setHeader("X-RateLimit-Remaining",s.times-((_=await d.functions.get(g+s.path))!=null?_:0)),e.setHeader("X-RateLimit-Reset-Every",s.timeout),await d.functions.set(g+s.path,((q=await d.functions.get(g+s.path))!=null?q:0)+1),setTimeout(async()=>{var n;await d.functions.set(g+s.path,((n=await d.functions.get(g+s.path))!=null?n:0)-1)},s.timeout),await d.functions.get(g+s.path)>s.times))return e.statusCode=429,x=!0,a.print((ee=d.message)!=null?ee:"Rate Limited"),e.end()}if(R&&!x)if(!j)Promise.resolve(t[o].code(a)).catch(s=>{a.error=s,x=!0,T("error",a)}).then(()=>e.end());else{if(t[o].data.addTypes&&(t[o].path.endsWith(".pdf")&&a.setHeader("Content-Type","application/pdf"),t[o].path.endsWith(".js")&&a.setHeader("Content-Type","text/javascript"),t[o].path.endsWith(".html")&&a.setHeader("Content-Type","text/html"),t[o].path.endsWith(".css")&&a.setHeader("Content-Type","text/css"),t[o].path.endsWith(".csv")&&a.setHeader("Content-Type","text/csv"),t[o].path.endsWith(".mpeg")&&a.setHeader("Content-Type","video/mpeg"),t[o].path.endsWith(".mp4")&&a.setHeader("Content-Type","video/mp4"),t[o].path.endsWith(".webm")&&a.setHeader("Content-Type","video/webm"),t[o].path.endsWith(".bmp")&&a.setHeader("Content-Type","image/bmp")),!("content"in t[o].data)){let s=fe.resolve(t[o].data.file),n,w=!1;try{n=$.readFileSync(s)}catch(p){w=!0,a.error=p,T("error",a)}return w?void 0:(e.write(n,"binary"),e.end())}return e.write(t[o].data.content,"binary"),e.end()}else T("notfound",a)}})});return h.listen(y,f),new Promise((u,e)=>{h.once("listening",()=>u({success:!0,port:y,message:"WEBSERVER STARTED",rawServer:h})),h.once("error",m=>{h.close(),e({success:!1,error:m,message:"WEBSERVER ERRORED"})})})}};
